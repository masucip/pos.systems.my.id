"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[888],{1629:(M,v,l)=>{l.d(v,{H:()=>F});var r=l(4438),f=l(1314);const d=["modalConfirm"],i=["confirmBox",""],w=["*"];function p(t,C){if(1&t){const m=r.RV6();r.j41(0,"div",1)(1,"h4",2),r.EFF(2),r.k0s(),r.j41(3,"button",3),r.bIt("click",function(){const _=r.eBV(m).$implicit;return r.Njj(_.dismiss("Cross click"))}),r.k0s()(),r.j41(4,"div",4),r.EFF(5),r.k0s(),r.j41(6,"div",5)(7,"button",6),r.bIt("click",function(_){const k=r.eBV(m).$implicit;return r.XpG().no(_),r.Njj(k.close())}),r.EFF(8),r.k0s(),r.j41(9,"button",7),r.bIt("click",function(_){const k=r.eBV(m).$implicit;return r.XpG().yes(_),r.Njj(k.close())}),r.EFF(10),r.k0s()()}if(2&t){const m=r.XpG();r.R7$(2),r.JRh(m.title),r.R7$(3),r.SpI(" ",m.msg," "),r.R7$(3),r.JRh(m.textNo),r.R7$(2),r.JRh(m.textYes)}}let F=(()=>{class t{constructor(m){this.modal=m,this.title="Konfirmasi",this.msg="Apakah anda yakin melakukan aksi ini ?",this.textYes="Ya",this.textNo="Tidak",this.onYes=new r.bkB,this.onNo=new r.bkB}ngOnClick(){this.openModalCOnfirm()}openModalCOnfirm(){this.modal.open(this.modalConfirm,{windowClass:"modal-animation",ariaLabelledBy:"modal-basic-title",size:"sm",centered:!0}).result.then(m=>{},m=>{})}yes(m){this.onYes.emit(m)}no(m){this.onNo.emit(m)}ngOnInit(){}static#t=this.\u0275fac=function(g){return new(g||t)(r.rXU(f.Bq))};static#n=this.\u0275cmp=r.VBU({type:t,selectors:[["","confirmBox",""]],viewQuery:function(g,_){if(1&g&&r.GBs(d,5),2&g){let k;r.mGM(k=r.lsd())&&(_.modalConfirm=k.first)}},hostBindings:function(g,_){1&g&&r.bIt("click",function(){return _.ngOnClick()})},inputs:{confirmBox:"confirmBox",title:"title",msg:"msg",textYes:"textYes",textNo:"textNo"},outputs:{onYes:"onYes",onNo:"onNo"},attrs:i,ngContentSelectors:w,decls:3,vars:0,consts:[["modalConfirm",""],[1,"modal-header","p-2"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close","text-reset",3,"click"],[1,"modal-body","p-2"],[1,"modal-footer","p-2","d-flex","justify-content-between"],[1,"btn","btn-outline","btn-outline-danger","float-left",3,"click"],[1,"btn","btn-outline","btn-outline-info",3,"click"]],template:function(g,_){1&g&&(r.NAR(),r.SdG(0),r.DNE(1,p,11,4,"ng-template",null,0,r.C5r))}})}return t})()},7554:(M,v,l)=>{l.d(v,{V:()=>d});var r=l(177),f=l(4438);let d=(()=>{class i{static#t=this.\u0275fac=function(F){return new(F||i)};static#n=this.\u0275mod=f.$C({type:i});static#e=this.\u0275inj=f.G2t({imports:[r.MD]})}return i})()},6888:(M,v,l)=>{l.r(v),l.d(v,{PosViewModule:()=>it});var r=l(177),f=l(126),d=l(4523),i=l(4341),w=l(3174),p=l(7469),F=l(3550),t=l(4438),C=l(1314);let m=(()=>{class a{constructor(n){this.modalActive=n}ngOnInit(){console.log(this.data),console.log(this.idx)}select(){this.modalActive.close({idx:this.idx,data:this.data.value})}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(C.Lw))};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["lib-modal-rincian"]],inputs:{data:"data",idx:"idx"},decls:28,vars:1,consts:[[1,"modal-header"],[1,"modal-body",3,"formGroup"],[1,"row","g-2"],[1,"col-md-12"],[1,"form-group"],[1,"form-label"],["type","text","formControlName","nama_produk",1,"form-control"],[1,"col-md-4"],["type","text","formControlName","harga_jual",1,"form-control"],["type","text","formControlName","jumlah_jual",1,"form-control"],["type","text","formControlName","potongan",1,"form-control"],[1,"modal-footer","d-flex","justify-content-between"],[1,"btn","btn-outline-warning",3,"click"],[1,"btn","btn-info",3,"click"]],template:function(e,o){1&e&&(t.nrm(0,"div",0),t.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t.EFF(6,"Nama Produk"),t.k0s(),t.nrm(7,"input",6),t.k0s()(),t.j41(8,"div",7)(9,"div",4)(10,"div",5),t.EFF(11,"Harga"),t.k0s(),t.nrm(12,"input",8),t.k0s()(),t.j41(13,"div",7)(14,"div",4)(15,"div",5),t.EFF(16,"Jumlah"),t.k0s(),t.nrm(17,"input",9),t.k0s()(),t.j41(18,"div",7)(19,"div",4)(20,"div",5),t.EFF(21,"Potongan"),t.k0s(),t.nrm(22,"input",10),t.k0s()()()(),t.j41(23,"div",11)(24,"button",12),t.bIt("click",function(){return o.modalActive.close()}),t.EFF(25,"Batal"),t.k0s(),t.j41(26,"button",13),t.bIt("click",function(){return o.select()}),t.EFF(27,"Selesai"),t.k0s()()),2&e&&(t.R7$(),t.Y8G("formGroup",o.data))},dependencies:[i.me,i.BC,i.cb,i.j4,i.JD]})}return a})();var g=l(4096);let _=(()=>{class a{constructor(){this.page=0,this.list=(0,g.Dd)(()=>p.X.penjualan.orderBy("tanggal").offset(this.page).limit(5).toArray())}changePage(){}static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();function k(a,u){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td",6),t.EFF(9),t.nI1(10,"number"),t.k0s(),t.nrm(11,"td"),t.k0s()),2&a){const n=u.$implicit;t.R7$(2),t.JRh(n.no_faktur),t.R7$(2),t.JRh(t.i5U(5,4,n.tanggal,"dd-MM-yyyy")),t.R7$(3),t.JRh(null==n.konsumen?null:n.konsumen.nama_konsumen),t.R7$(2),t.JRh(t.i5U(10,7,n.grand_total,"1.2-2"))}}let E=(()=>{class a{constructor(n,e){this.penjualan=n,this.activeModal=e}ngOnInit(){}edit(n){this.activeModal.close(n)}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(_),t.rXU(C.Lw))};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["lib-history"]],decls:20,vars:4,consts:[[1,"modal-header"],[1,"modal-body"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],[1,"btn",3,"click"],[1,"modal-footer"],["align","right"]],template:function(e,o){1&e&&(t.nrm(0,"div",0),t.j41(1,"div",1)(2,"table",2)(3,"thead")(4,"tr")(5,"td"),t.EFF(6,"No Faktur"),t.k0s(),t.j41(7,"td"),t.EFF(8,"Tanggal"),t.k0s(),t.j41(9,"td"),t.EFF(10,"Konsumen"),t.k0s(),t.j41(11,"td"),t.EFF(12,"Total"),t.k0s(),t.nrm(13,"td"),t.k0s()(),t.j41(14,"tbody"),t.DNE(15,k,12,10,"tr",3),t.nI1(16,"async"),t.k0s()(),t.j41(17,"button",4),t.bIt("click",function(){return o.penjualan.page=o.penjualan.page+1}),t.EFF(18),t.k0s()(),t.nrm(19,"div",5)),2&e&&(t.R7$(15),t.Y8G("ngForOf",t.bMT(16,2,o.penjualan.list)),t.R7$(3),t.SpI("Next ",o.penjualan.page,""))},dependencies:[r.Sq,r.Jj,r.QX,r.vh]})}return a})(),P=(()=>{class a{transform(n,e){let o=0,s=e.split(",");return n.forEach(c=>{let h=0;s.forEach((j,b)=>{let y=j.substring(0,1),I=j.substring(1,j.length),B=parseFloat(c[I]);"+"==y?h+=B:"-"==y?h-=B:"*"==y?h*=B:"/"==y?h/=B:h=parseFloat(c[j]||0)}),o+=h}),o}static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275pipe=t.EJ8({name:"sum",type:a,pure:!0})}return a})();var T=l(1629),J=l(9830);const V=["video"],D=["dataCanvas"],O=["drawingCanvas"];let G=(()=>{class a{constructor(){this.capturing=!1,this.cpt="",this.onFound=new t.bkB}ngAfterViewInit(){this.video=this.videoElm?.nativeElement,this.dataCanvas=this.dataCanvasElm?.nativeElement,this.drawingCanvas=this.drawingCanvasElm?.nativeElement,this.dataCtx=this.dataCanvas?.getContext("2d",{willReadFrequently:!0}),this.drawingCtx=this.drawingCanvas?.getContext("2d")}ngOnInit(){this.constraints={audio:!1,video:{facingMode:"environment"}}}getDetector(){return(0,d.A)(function*(){const n=yield BarcodeDetector.getSupportedFormats();return new BarcodeDetector({formats:n})})()}parseResults(n){const e=n.length>0?n[0]:void 0;if(e&&""!==e.rawValue){clearTimeout(this.scanId),this.code=e,this.drawFrame();const{cornerPoints:o}=e;this.drawBoundingBox(o,!1),this.capturing=!1,this.onFound.emit(e),setTimeout(()=>{this.scan()},1e3)}else this.scanId=setTimeout(this.getResults.bind(this),1e3)}connectedCallback(){var n=this;return(0,d.A)(function*(){n.detector=yield n.getDetector(),n.video.onplaying=(0,d.A)(function*(){n.dataCanvas.width=n.dataCanvas.offsetWidth,n.dataCanvas.height=n.dataCanvas.offsetHeight,n.drawingCanvas.width=n.dataCanvas.offsetWidth,n.drawingCanvas.height=n.dataCanvas.offsetHeight,n.getResults()})})()}scan(){var n=this;return(0,d.A)(function*(){n.clearCanvas();try{n.capturing=!0,n.code=null,n.stream instanceof MediaStream?(n.drawingCtx.clearRect(0,0,n.drawingCanvas.offsetWidth,n.drawingCanvas.offsetHeight),yield n.getResults()):(n.stream=yield navigator.mediaDevices.getUserMedia(n.constraints),n.startVideo(),yield n.connectedCallback())}catch(e){if(console.log(e),"function"==typeof n.permissionDialog.showModal)n.permissionDialog.showModal();else{const o=n.permissionDialog.querySelector("p").textContent;alert(o)}n.capturing=!1}})()}stopScan(){clearTimeout(this.scanId),this.clearCanvas(),this.capturing=!1,this.stream.getTracks().forEach(n=>n.stop()),this.stream=null,this.video.srcObject=null}startVideo(){this.video.srcObject=this.stream}drawLine(n,e){this.drawingCtx.beginPath(),this.drawingCtx.lineJoin="round",this.drawingCtx.moveTo(n.x,n.y),this.drawingCtx.lineTo(e.x,e.y),this.drawingCtx.lineWidth=2,this.drawingCtx.strokeStyle="#FF3B58",this.drawingCtx.stroke()}drawFrame(){this.drawingCtx.drawImage(this.video,0,0,this.dataCanvas.width,this.dataCanvas.height)}drawShapeFromCoords(n){const e=n[0];n.slice(1).reduce((o,s)=>(this.drawLine(o,s),s),e)}DOMRectToBoundingBox(n){const{x:e,y:o,width:s,height:c}=n;return[{x:e,y:o},{x:e+s,y:o},{x:e+s,y:o+c},{x:e,y:o+c}]}clearCanvas(){this.drawingCtx.clearRect(0,0,this.drawingCanvas.width,this.drawingCanvas.height)}drawBoundingBox(n,e=!0){const[o,s,c,h]=n;e&&this.clearCanvas(),this.drawLine(o,s),this.drawLine(s,c),this.drawLine(c,h),this.drawLine(h,o)}getResults(){var n=this;return(0,d.A)(function*(){if(n.code)return clearTimeout(n.scanId),!1;try{let e=n.getImageData(n.video);const o=yield n.detector.detect(e);return e=null,n.parseResults(o),!0}catch(e){return console.log("error",e),!1}})()}getImageData(n){return this.dataCtx.drawImage(n,0,0,this.dataCanvas.width,this.dataCanvas.height),this.dataCtx.getImageData(0,0,this.dataCanvas.width,this.dataCanvas.height)}cek(){console.log(this.dataCanvasElm)}static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["lib-barcode"]],viewQuery:function(e,o){if(1&e&&(t.GBs(V,5),t.GBs(D,5),t.GBs(O,5)),2&e){let s;t.mGM(s=t.lsd())&&(o.videoElm=s.first),t.mGM(s=t.lsd())&&(o.dataCanvasElm=s.first),t.mGM(s=t.lsd())&&(o.drawingCanvasElm=s.first)}},hostVars:1,hostBindings:function(e,o){2&e&&t.BMQ("capturing",o.cpt)},outputs:{onFound:"onFound"},decls:22,vars:0,consts:[["core1",""],["dataCanvas",""],["video",""],["drawingCanvas",""],["id","container img-thumbnail"],["id","video-container"],["id","data-canvas"],["autoplay","","playsinline",""],["id","drawing-canvas"],["id","frame"],[1,"corner","top-left"],[1,"corner","top-right"],[1,"corner","bottom-right"],[1,"corner","bottom-left"],["part","dialog"],["id","close"]],template:function(e,o){1&e&&(t.nrm(0,"div",null,0),t.j41(2,"div",4)(3,"div",5),t.nrm(4,"canvas",6,1)(6,"video",7,2)(8,"canvas",8,3),t.j41(10,"div",9),t.nrm(11,"div",10)(12,"div",11)(13,"div",12)(14,"div",13),t.k0s()(),t.j41(15,"dialog",14)(16,"h3"),t.EFF(17,"No access to camera"),t.k0s(),t.j41(18,"p"),t.EFF(19," Your device does not have permission to access the camera and microphone. Please enable this in your device's settings. "),t.k0s(),t.j41(20,"button",15),t.EFF(21,"OK"),t.k0s()()())},styles:["[_nghost-%COMP%] {\n      display: block;\n      --video-width: 100%;\n      --video-height: auto;\n      --video-background-color: #cccccc;\n      --dialog-background-color: #ffffff;\n      --dialog-backdrop-background-color: #cecece;\n    }\n    \n    #container[_ngcontent-%COMP%] {\n      position: relative;\n      width: var(--video-width);\n      background-color: var(--video-background-color);\n    }\n    \n    @media screen and (min-width: 1024px) {\n      #container[_ngcontent-%COMP%] {\n        width: 100%;\n        height: auto;\n      }\n    }\n    \n    #video-container[_ngcontent-%COMP%] {\n      position: relative;\n      overflow: hidden;\n      height: var(--video-height);\n      max-height: var(--video-height);\n    }\n    \n    video[_ngcontent-%COMP%] {\n      width: 100%;\n      display: block;\n      object-fit: cover;\n    }\n    \n    canvas[_ngcontent-%COMP%] {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n    \n    #data-canvas[_ngcontent-%COMP%] {\n      visibility: hidden;\n    }\n    \n    #drawing-canvas[_ngcontent-%COMP%] {\n      background-color: transparent;\n      visibility: hidden;\n    }\n    \n    #frame[_ngcontent-%COMP%] {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: transparent;\n      transform-origin: center center;\n      transform: scale(1.1);\n      transition: transform .3s ease-out;\n    }\n    \n    [capturing][_nghost-%COMP%]   #frame[_ngcontent-%COMP%] {\n      transform: scale(0.7);\n    }\n    \n    [capturing][_nghost-%COMP%]   #drawing-canvas[_ngcontent-%COMP%] {\n      visibility: visible;\n    }\n    \n    [no-frame][_nghost-%COMP%]   #frame[_ngcontent-%COMP%] {\n      display: none;\n    }\n    \n    .corner[_ngcontent-%COMP%] {\n      position: absolute;\n      width: 50px;\n      height: 50px;\n      border: 3px solid #ffff00;\n      clip-path: polygon(0 46px, 46px 46px, 46px 0, 0 0);\n    }\n    \n    .top-left[_ngcontent-%COMP%] {\n      top: 0;\n      left: 0;\n    }\n    \n    .top-right[_ngcontent-%COMP%] {\n      top: 0;\n      right: 0;\n      transform: rotate(90deg);\n    }\n    \n    .bottom-right[_ngcontent-%COMP%] {\n      bottom: 0;\n      right: 0;\n      transform: rotate(180deg);\n    }\n    \n    .bottom-left[_ngcontent-%COMP%] {\n      bottom: 0;\n      left: 0;\n      transform: rotate(-90deg);\n    }\n    \n    dialog[_ngcontent-%COMP%] {\n      width: min(50ch, 100vw);\n      border: 1px solid #cccccc;\n      transform-origin: center center;\n      animation: _ngcontent-%COMP%_fade-in-slide-in .3s;\n      background-color: var(--dialog-background-color);\n    }\n\n    dialog[_ngcontent-%COMP%]::backdrop {\n      opacity: .4;\n      background-color: var(--dialog-backdrop-background-color);\n    }\n\n    @keyframes _ngcontent-%COMP%_fade-in-slide-in {\n      from {\n        opacity: 0;\n        transform: translateY(-20px);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0);\n      }\n    }"]})}return a})();function x(a){function u(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var e=n.done;return Promise.resolve(n.value).then(function(o){return{value:o,done:e}})}return(x=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return u(this.n.apply(this.s,arguments))},return:function(e){var o=this.s.return;return void 0===o?Promise.resolve({value:e,done:!0}):u(o.apply(this.s,arguments))},throw:function(e){var o=this.s.return;return void 0===o?Promise.reject(e):u(o.apply(this.s,arguments))}},new x(a)}const R=new class $ extends g.Ay{constructor(){super("dbPWA"),this.version(3).stores({setting:"++id, key"})}};let A=(()=>{class a{isStoragePersisted(){return(0,d.A)(function*(){return(yield navigator.storage)&&navigator.storage.persisted&&navigator.storage.persisted()})()}openFile(){var n=this;return(0,d.A)(function*(){let e=yield n.isStoragePersisted();if(console.log("Checkpresisten",e),e||(yield n.persist(),console.log(yield n.isStoragePersisted())),navigator.storage&&navigator.storage.estimate){const o=yield navigator.storage.estimate();console.log(`Quota: ${o.quota}`),console.log(`Usage: ${o.usage}`)}else console.error("StorageManager not found")})()}persist(){return(0,d.A)(function*(){return(yield navigator.storage)&&navigator.storage.persist&&navigator.storage.persist()})()}openFolder(){return(0,d.A)(function*(){let n,e=yield R.setting.where("key").equals("directory").first();e?n=e.value:(n=yield window.showDirectoryPicker(),yield R.setting.add({key:"directory",value:n})),yield n.getFileHandle("My Notes.txt",{create:!0});var c,o=!1,s=!1;try{for(var j,h=function N(a){var u,n,e,o=2;for(typeof Symbol<"u"&&(n=Symbol.asyncIterator,e=Symbol.iterator);o--;){if(n&&null!=(u=a[n]))return u.call(a);if(e&&null!=(u=a[e]))return new x(u.call(a));n="@@asyncIterator",e="@@iterator"}throw new TypeError("Object is not async iterable")}(n.values());o=!(j=yield h.next()).done;o=!1){const b=j.value;"file"===b.kind&&b.getFile().then(y=>console.log(`${y.name} (${y.size})`))}}catch(b){s=!0,c=b}finally{try{o&&null!=h.return&&(yield h.return())}finally{if(s)throw c}}})()}scan(){return(0,d.A)(function*(){"bluetooth"in navigator&&(yield function(){var e=(0,d.A)(function*({bleService:o,bleCharacteristic:s}){try{const c=yield navigator.bluetooth.requestDevice({filters:[{services:[o]}]});c.addEventListener("gattserverdisconnected",()=>{});const b=yield(yield(yield c.gatt.connect()).getPrimaryService(o)).getCharacteristic(s);return yield b.startNotifications(),b.addEventListener("characteristicvaluechanged",y=>{const I=y.target.value.getUint8(0);console.log(`${s} changed`,I)}),b.readValue(),b}catch(c){console.error(c)}});return function(s){return e.apply(this,arguments)}}()({bleService:"battery_service",bleCharacteristic:"battery_level"}))})()}static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["lib-bluetooth"]],decls:0,vars:0,template:function(e,o){}})}return a})();const S=["modalBayar"],U=["barcodeScanner"],X=(a,u)=>({"text-info":a,"text-muted":u});function Y(a,u){if(1&a){const n=t.RV6();t.j41(0,"div",38)(1,"div",39),t.bIt("click",function(){const o=t.eBV(n).$implicit,s=t.XpG();return t.Njj(s.addItem(o))}),t.j41(2,"div",40)(3,"div",41),t.EFF(4),t.j41(5,"p",25),t.EFF(6),t.nI1(7,"number"),t.k0s()()()()()}if(2&a){const n=u.$implicit;t.R7$(4),t.SpI(" ",n.nama_produk," "),t.R7$(2),t.JRh(t.bMT(7,2,n.harga_jual))}}function L(a,u){if(1&a){const n=t.RV6();t.j41(0,"div",42)(1,"div",40)(2,"button",43),t.bIt("click",function(){const o=t.eBV(n).$implicit;return t.Njj(o.get("jumlah_jual").setValue(o.get("jumlah_jual").value-1))}),t.nrm(3,"i",44),t.k0s(),t.j41(4,"div",45),t.bIt("click",function(){const o=t.eBV(n),s=o.$implicit,c=o.index,h=t.XpG();return t.Njj(h.openModalRincian(c,s.value))}),t.j41(5,"h5",25),t.EFF(6),t.k0s(),t.j41(7,"div",8)(8,"div",9)(9,"div",46)(10,"b"),t.EFF(11),t.k0s()()(),t.j41(12,"div"),t.EFF(13),t.nI1(14,"number"),t.k0s()()(),t.j41(15,"button",47),t.bIt("onYes",function(){const o=t.eBV(n).index,s=t.XpG();return t.Njj(s.removeItem(o))}),t.nrm(16,"i",48),t.k0s(),t.j41(17,"button",49),t.bIt("click",function(){const o=t.eBV(n).$implicit;return t.Njj(o.get("jumlah_jual").setValue(o.get("jumlah_jual").value+1))}),t.nrm(18,"i",50),t.k0s()()()}if(2&a){const n=u.$implicit;t.Y8G("formGroupName",u.index),t.R7$(2),t.Y8G("disabled",1==n.get("jumlah_jual").value),t.R7$(4),t.JRh(n.get("produk").get("nama_produk").value),t.R7$(5),t.JRh(n.get("jumlah_jual").value),t.R7$(2),t.SpI(" Rp. ",t.bMT(14,5,n.get("jumlah_jual").value*n.get("harga_jual").value)," ")}}function H(a,u){if(1&a&&(t.j41(0,"div",51)(1,"div",52)(2,"div",53)(3,"div",54),t.EFF(4,"Nama Produk"),t.k0s(),t.nrm(5,"input",55),t.k0s()(),t.j41(6,"div",16)(7,"button",56),t.EFF(8,"Ok"),t.k0s()()()),2&a){const n=t.XpG();t.Y8G("formGroup",n.formItem)}}function W(a,u){if(1&a&&(t.j41(0,"option",71),t.EFF(1),t.k0s()),2&a){const n=u.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.nama_rekening)}}function K(a,u){if(1&a){const n=t.RV6();t.j41(0,"div",64)(1,"div",65)(2,"select",66),t.DNE(3,W,2,2,"option",67),t.nI1(4,"async"),t.k0s()(),t.nrm(5,"input",68),t.j41(6,"div",69)(7,"button",70),t.bIt("click",function(){const o=t.eBV(n).index,s=t.XpG(2);return t.Njj(s.removeBayar(o))}),t.nrm(8,"b",48),t.k0s()()()}if(2&a){const n=u.index,e=t.XpG(2);t.Y8G("formGroupName",n),t.R7$(3),t.Y8G("ngForOf",t.bMT(4,3,e.rekening.list)),t.R7$(4),t.Y8G("disabled",0==n)}}function Q(a,u){if(1&a){const n=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.saveJual())}),t.EFF(1,"Selesai"),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("disabled",n.formJual.invalid)}}function z(a,u){if(1&a){const n=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(n);const o=t.XpG(2);return t.Njj(o.updateJual())}),t.EFF(1,"Update Penjualan"),t.k0s()}if(2&a){const n=t.XpG(2);t.Y8G("disabled",n.formJual.invalid)}}function Z(a,u){if(1&a){const n=t.RV6();t.j41(0,"div",51)(1,"div",7)(2,"div",8)(3,"h1",57),t.EFF(4,"Total"),t.k0s(),t.j41(5,"h1",25),t.EFF(6),t.nI1(7,"sum"),t.nI1(8,"number"),t.k0s()()(),t.j41(9,"div",58),t.DNE(10,K,9,5,"div",59),t.j41(11,"button",60),t.bIt("click",function(){t.eBV(n);const o=t.XpG();return t.Njj(o.addBayar())}),t.EFF(12,"Tambah Pembayaran Lain"),t.k0s()(),t.j41(13,"div",16)(14,"div",8)(15,"h1",61),t.EFF(16,"Dibayar"),t.k0s(),t.j41(17,"h1",25),t.EFF(18),t.nI1(19,"sum"),t.nI1(20,"number"),t.k0s()(),t.j41(21,"div",8)(22,"h3",9),t.EFF(23,"Sisa"),t.k0s(),t.j41(24,"h1",25),t.EFF(25),t.nI1(26,"sum"),t.nI1(27,"sum"),t.nI1(28,"number"),t.k0s()()(),t.j41(29,"div",62),t.DNE(30,Q,2,1,"button",63)(31,z,2,1,"button",63),t.k0s()()}if(2&a){const n=t.XpG();t.Y8G("formGroup",n.formJual),t.R7$(6),t.JRh(t.bMT(8,10,t.i5U(7,7,n.formJual.get("rincian").value,"harga_jual,*jumlah_jual,-potongan"))),t.R7$(4),t.Y8G("ngForOf",n.formJual.get("bayar").controls),t.R7$(8),t.JRh(t.bMT(20,15,t.i5U(19,12,n.formJual.get("bayar").value,"jumlah_bayar"))),t.R7$(7),t.JRh(t.bMT(28,23,t.i5U(26,17,n.formJual.get("bayar").value,"jumlah_bayar")-t.i5U(27,20,n.formJual.get("rincian").value,"harga_jual,*jumlah_jual,-potongan")||0)),t.R7$(5),t.Y8G("ngIf",!n.formJual.get("id").value),t.R7$(),t.Y8G("ngIf",n.formJual.get("id").value)}}let q=(()=>{class a{keyboard(n){"Enter"==n.key?(this.addItemByBarcode(this.keys),this.keys=""):"Escape"==n.key?this.keys="":this.keys+=n.key}constructor(n,e,o,s,c){this.datePipe=n,this.sumPipe=e,this.produk=o,this.rekening=s,this.modal=c,this.listJual=[],this.keys="",this.token="",this.formJual=new i.gE({id:new i.MJ(0),no_faktur:new i.MJ("",i.k0.required),tanggal:new i.MJ("",i.k0.required),id_konsumen:new i.MJ(0),konsumen:new i.gE({id:new i.MJ("",i.k0.required),nama_konsumen:new i.MJ("")}),total_potongan:new i.MJ(""),sub_total:new i.MJ(""),status_pajak:new i.MJ(1),persen_ppn:new i.MJ(0),nilai_ppn:new i.MJ(0),persen_pph:new i.MJ(0),nilai_pph:new i.MJ(0),grand_total:new i.MJ(0),total_dibayar:new i.MJ(0),total_sisa:new i.MJ(0),keterangan:new i.MJ(""),rincian:new i.Yp([],i.k0.required),bayar:new i.Yp([],i.k0.required)}),this.formItem=this.createItem(),this.token=localStorage.getItem("token")}ngOnInit(){this.resetForm()}scan(){this.barcodeScanner.capturing?this.barcodeScanner.stopScan():this.barcodeScanner.scan()}onFound(n){n.rawValue&&this.addItemByBarcode(n.rawValue)}addItemByBarcode(n){p.X.produk.where("barcode").equalsIgnoreCase(n).first().then(e=>{e&&this.addItem(e)})}resetForm(){var n=this;return(0,d.A)(function*(){let e=(new Date).getTime();n.formJual.reset(),n.formJual.get("rincian").clear(),n.formJual.get("bayar").clear();let o={no_faktur:"FK-"+e,tanggal:n.datePipe.transform(Date.now(),"yyyy-MM-dd"),id_konsumen:0,konsumen:{id:0,nama_konsumen:"Suna"},total_potongan:0,sub_total:0,status_pajak:0,persen_ppn:0,nilai_ppn:0,persen_pph:0,nilai_pph:0,grand_total:0,total_dibayar:0,total_sisa:0,keterangan:"",rincian:[],bayar:[]};n.formJual.patchValue(o);let s=yield p.X.rekening.where("default").equals("2").first();n.formJual.get("bayar").push(n.createBayar({rekening:s}))})()}createItem(n={produk:{}}){return new i.gE({id:new i.MJ(n.id),id_produk:new i.MJ(0),produk:new i.gE({id:new i.MJ(n.produk.id,i.k0.required),nama_produk:new i.MJ(n.produk.nama_produk)}),nama_produk:new i.MJ(n.nama_produk||n.produk.nama_produk),harga_jual:new i.MJ(n.harga_jual||n.produk.harga_jual,i.k0.required),jumlah_jual:new i.MJ(n.jumlah_jual||1,i.k0.required),jumlah_satuan:new i.MJ(n.jumlah_satuan||1),potongan:new i.MJ(n.potongan||0),id_satuan:new i.MJ(n.id_satuan||0),keterangan:new i.MJ(n.keterangan||""),modal:new i.MJ(n.modal||0)})}createBayar(n={rekening:{}}){return new i.gE({id:new i.MJ(n.id),tanggal_bayar:new i.MJ(n.tanggal_bayar||Date(),i.k0.required),jumlah_bayar:new i.MJ(n.jumlah_bayar,i.k0.required),rekening:new i.gE({id:new i.MJ(n.rekening.id,i.k0.required),nama_rekening:new i.MJ(n.rekening.nama_rekening)})})}addBayar(){this.formJual.get("bayar").push(this.createBayar())}removeBayar(n){this.formJual.get("bayar").removeAt(n)}findByBarcode(n){}addItem(n){let e=this.formJual.get("rincian").value.findIndex(o=>o.produk.id==n.id);e<0?this.formJual.get("rincian").push(this.createItem({produk:n})):this.formJual.get("rincian").at(e).get("jumlah_jual").setValue(this.formJual.get("rincian").at(e).get("jumlah_jual").value+1)}removeItem(n){this.formJual.get("rincian").removeAt(n)}openModalRincian(n,e){let o=this.modal.open(m,{windowClass:"modal-animation",ariaLabelledBy:"modal-basic-title",size:"lg"});o.componentInstance.idx=n,o.componentInstance.data=this.createItem(e),o.closed.subscribe(s=>{s&&s.data&&this.formJual.get("rincian").at(s.idx).patchValue(s.data)})}openModalBayar(){let n=this.formJual.value;delete n.id;let e=this.sumPipe.transform(n.rincian,"jumlah_jual,*harga_jual,-potongan");n.sub_total=e,this.mdlBayar=this.modal.open(this.modalBayar,{windowClass:"modal-animation",ariaLabelledBy:"modal-basic-title",size:"md"})}openModalCariKonsumen(){}openModalCariPenjualan(){this.modal.open(E,{windowClass:"modal-animation",ariaLabelledBy:"modal-basic-title",size:"lg"}).result.then(n=>{n.id&&(console.log(n),this.formJual.patchValue(n),this.formJual.get("rincian").clear(),this.formJual.get("bayar").clear(),n.rincian.forEach(e=>{this.formJual.get("rincian").push(this.createItem(e))}),n.bayar.forEach(e=>{this.formJual.get("bayar").push(this.createBayar(e))}))},n=>{})}saveJual(){let n=this.formJual.value;delete n.id,p.X.penjualan.add(n).then(e=>{this.resetForm(),this.mdlBayar.close()})}updateJual(){console.log(this.formJual.value);let n=this.formJual.value;p.X.penjualan.update(parseInt(this.formJual.value.id),n).then(e=>{this.resetForm(),this.mdlBayar.close()})}cek(){console.log(this.formJual)}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(r.vh),t.rXU(P),t.rXU(w.X),t.rXU(F.T),t.rXU(C.Bq))};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["lib-pos-view"]],viewQuery:function(e,o){if(1&e&&(t.GBs(S,5),t.GBs(U,5)),2&e){let s;t.mGM(s=t.lsd())&&(o.modalBayar=s.first),t.mGM(s=t.lsd())&&(o.barcodeScanner=s.first)}},hostBindings:function(e,o){1&e&&t.bIt("keyup",function(c){return o.keyboard(c)},!1,t.EBC)},decls:71,vars:23,consts:[["cariProduk",""],["barcodeScanner",""],["modalDetailItem",""],["modalBayar",""],[1,"row"],[1,"col-md-8",2,"padding","1vh"],[1,"card","m-0","shadow","rounded-xl",2,"height","98vh"],[1,"card-header","p-2"],[1,"d-flex"],[1,"flex-grow-1"],["type","text","placeholder","Cari produk",1,"form-control","rounded-xl","border","border-info"],[1,"btn","btn-sm","btn-link",3,"click"],[1,"bi-qr-code-scan","fs-5","fw-bold",3,"ngClass"],[1,"card-body","overflow-auto","p-2"],[1,"row","g-2"],["class","col-md-4 pr-0",4,"ngFor","ngForOf"],[1,"card-footer","p-2"],["routerLink","setting",1,"btn","btn-outline-primary","rounded-xl"],[1,"bi-gear"],[1,"col-md-3",2,"padding","1vh",3,"formGroup"],[1,"card-header","p-2","d-flex","justify-content-between"],[1,"mb-1"],[1,"float-right","mb-1"],["formArrayName","rincian",1,"card-body","overflow-auto","p-2"],["class","card shadow rounded-xl mb-2",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mb-0"],[1,"btn","btn-outline-info","rounded-xl",3,"click"],[1,"bi-search"],[1,"col-md-1",2,"padding","1vh"],[1,"card","shadow","mb-0",2,"height","98vh"],[1,"card-body","p-1"],[1,"d-flex","flex-column","h-100"],[2,"zoom","25%",3,"onFound"],["src","assets/saweria.png","alt","",1,"img-fluid"],[1,"btn","w-100","mb-1","btn-outline-info","rounded-xl",3,"click"],[1,"bi-card-list","fs-2"],[1,"btn","w-100","mb-1","btn-primary","float-right","rounded-xl",3,"click","disabled"],[1,"bi-credit-card","fs-2"],[1,"col-md-4","pr-0"],[1,"card","shadow","rounded-xl","mb-0",3,"click"],[1,"card-body","d-flex","p-0"],[1,"flex-grow-1","p-2","text-truncate"],[1,"card","shadow","rounded-xl","mb-2",3,"formGroupName"],[1,"btn","rounded-left-xl","rounded-0","btn-info",3,"click","disabled"],[1,"bi-dash-circle"],[1,"flex-grow-1","p-2","text-truncate",3,"click"],[1,"d-flex","align-item-beetween"],["confirmBox","","msg","Apakah anda yakin untuk menghapus item ini ?",1,"btn","rounded-0","btn-danger",3,"onYes"],[1,"bi-trash"],[1,"btn","rounded-right-xl","rounded-0","btn-info",3,"click"],[1,"bi-plus-circle"],[1,"card","shadow",3,"formGroup"],[1,"card-body","p-2"],[1,"form-group"],[1,"form-label"],["type","text","formControlName","nama_produk",1,"form-control"],[1,"btn","btn-primary","rounded-xl","float-right"],[1,"mb-0","flex-grow-1"],["formArrayName","bayar",1,"card-body","p-2"],["class","input-group input-group-lg mb-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"btn","btn-info","btn-sm","btn-block",3,"click"],[1,"flex-grow-1","text-muted"],[1,"card-footer","p-2","d-flex","justify-content-between"],["class","btn btn-primary rounded-xl float-right",3,"disabled","click",4,"ngIf"],[1,"input-group","input-group-lg","mb-3",3,"formGroupName"],["formGroupName","rekening",1,"input-group-prepend"],["formControlName","id","id","inputGroupSelect02",1,"form-control","form-control-lg","rounded-end-0"],[3,"value",4,"ngFor","ngForOf"],["type","text","ngbAutofocus","","formControlName","jumlah_bayar","mask","separator","thousandSeparator",".",1,"form-control"],[1,"input-group-append"],[1,"btn","btn-danger","btn-lg","rounded-start-0",3,"click","disabled"],[3,"value"],[1,"btn","btn-primary","rounded-xl","float-right",3,"click","disabled"]],template:function(e,o){if(1&e){const s=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9),t.nrm(6,"input",10,0),t.k0s(),t.j41(8,"div")(9,"button",11),t.bIt("click",function(){return t.eBV(s),t.Njj(o.scan())}),t.nrm(10,"b",12),t.k0s()()()(),t.j41(11,"div",13)(12,"div",14),t.DNE(13,Y,8,4,"div",15),t.nI1(14,"async"),t.k0s()(),t.j41(15,"div",16)(16,"button",17),t.nrm(17,"i",18),t.EFF(18," Pengaturan "),t.k0s()()()(),t.j41(19,"div",19)(20,"div",6)(21,"div",20)(22,"h3",21),t.EFF(23),t.k0s(),t.j41(24,"h3",22),t.EFF(25),t.nI1(26,"sum"),t.nI1(27,"number"),t.k0s()(),t.j41(28,"div",20)(29,"i"),t.EFF(30),t.k0s(),t.j41(31,"i"),t.EFF(32),t.nI1(33,"date"),t.k0s()(),t.j41(34,"div",23),t.DNE(35,L,19,7,"div",24),t.k0s(),t.j41(36,"div",16)(37,"div",8)(38,"div",9)(39,"i"),t.EFF(40,"Konsumen"),t.k0s(),t.j41(41,"p",25),t.EFF(42),t.k0s()(),t.j41(43,"div")(44,"button",26),t.bIt("click",function(){return t.eBV(s),t.Njj(o.openModalCariKonsumen())}),t.nrm(45,"i",27),t.EFF(46," Cari "),t.k0s()()()(),t.nrm(47,"div",16),t.k0s()(),t.j41(48,"div",28)(49,"div",29)(50,"div",30)(51,"div",31)(52,"div",9)(53,"lib-barcode",32,1),t.bIt("onFound",function(h){return t.eBV(s),t.Njj(o.onFound(h))}),t.k0s(),t.nrm(55,"lib-bluetooth")(56,"img",33),t.k0s(),t.j41(57,"div")(58,"button",34),t.bIt("click",function(){return t.eBV(s),t.Njj(o.openModalCariPenjualan())}),t.nrm(59,"i",35),t.j41(60,"p",25),t.EFF(61,"History"),t.k0s()(),t.j41(62,"button",36),t.bIt("click",function(){return t.eBV(s),t.Njj(o.openModalBayar())}),t.nrm(63,"i",37),t.j41(64,"p",25),t.EFF(65,"Bayar"),t.k0s()()()()()()()(),t.DNE(66,H,9,1,"ng-template",null,2,t.C5r)(68,Z,32,25,"ng-template",null,3,t.C5r),t.nrm(70,"router-outlet")}if(2&e){const s=t.sdS(54);t.R7$(10),t.Y8G("ngClass",t.l_i(20,X,s.capturing,!s.capturing)),t.R7$(3),t.Y8G("ngForOf",t.bMT(14,10,o.produk.list)),t.R7$(6),t.Y8G("formGroup",o.formJual),t.R7$(4),t.SpI("",o.formJual.get("rincian").length," Item"),t.R7$(2),t.JRh(t.bMT(27,15,t.i5U(26,12,o.formJual.get("rincian").value,"harga_jual,*jumlah_jual,-potongan"))),t.R7$(5),t.SpI("#",o.formJual.get("no_faktur").value,""),t.R7$(2),t.JRh(t.i5U(33,17,o.formJual.get("tanggal").value,"dd-MM-yyyy")),t.R7$(3),t.Y8G("ngForOf",o.formJual.get("rincian").controls),t.R7$(7),t.JRh(o.formJual.get("konsumen").value.nama_konsumen),t.R7$(20),t.Y8G("disabled",o.formJual.get("rincian").invalid)}},dependencies:[r.YU,r.Sq,r.bT,f.n3,f.Wk,i.xH,i.y7,i.me,i.wz,i.BC,i.cb,i.j4,i.JD,i.$R,i.v8,T.H,J.Zr,G,A,r.Jj,r.QX,r.vh,P]})}return a})();var tt=l(7554);let nt=(()=>{class a{constructor(){}cek(){return(0,d.A)(function*(){const n="BarcodeDetector"in window&&(yield BarcodeDetector.getSupportedFormats()).includes("qr_code");console.log(n)})()}static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac})}return a})(),et=(()=>{class a{static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275mod=t.$C({type:a});static#e=this.\u0275inj=t.G2t({providers:[nt],imports:[r.MD]})}return a})(),ot=(()=>{class a{static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275mod=t.$C({type:a});static#e=this.\u0275inj=t.G2t({imports:[r.MD]})}return a})();const at=[{path:"",component:q,children:[{path:"setting",loadChildren:()=>l.e(686).then(l.bind(l,6686)).then(a=>a.SettingModule)}]}];let it=(()=>{class a{static#t=this.\u0275fac=function(e){return new(e||a)};static#n=this.\u0275mod=t.$C({type:a});static#e=this.\u0275inj=t.G2t({providers:[(0,J.Dw)(),r.vh,P],imports:[r.MD,f.iI.forChild(at),i.YN,i.X1,tt.V,et,ot]})}return a})()},3174:(M,v,l)=>{l.d(v,{X:()=>w});var r=l(4523),f=l(4096),d=l(7469),i=l(4438);let w=(()=>{class p{constructor(){this.list=(0,f.Dd)(()=>d.X.produk.toArray())}add(t){delete t.id,d.X.produk.add(t)}update(t){d.X.produk.update(t.id,t)}hapus(t){return(0,r.A)(function*(){yield d.X.produk.delete(t)})()}static#t=this.\u0275fac=function(C){return new(C||p)};static#n=this.\u0275prov=i.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},3550:(M,v,l)=>{l.d(v,{T:()=>w});var r=l(4523),f=l(4096),d=l(7469),i=l(4438);let w=(()=>{class p{constructor(){this.list=(0,f.Dd)(()=>d.X.rekening.toArray())}add(t){delete t.id,d.X.rekening.add(t)}update(t){d.X.rekening.update(t.id,t)}hapus(t){return(0,r.A)(function*(){yield d.X.rekening.delete(t)})()}static#t=this.\u0275fac=function(C){return new(C||p)};static#n=this.\u0275prov=i.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()}}]);