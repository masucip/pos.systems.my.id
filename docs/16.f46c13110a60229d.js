(self.webpackChunkweb=self.webpackChunkweb||[]).push([[16],{1016:(wt,Oe,j)=>{"use strict";j.r(Oe),j.d(Oe,{AppDB:()=>xe.E,DashboardPosModule:()=>je,PersediaanPosModule:()=>Me,PosModule:()=>et,dbPOS:()=>xe.X});var we=j(177),F=j(126),V=j(4341),re=j(9830),Q=j(4438);const Te=[{path:"",loadChildren:()=>j.e(168).then(j.bind(j,7168)).then(J=>J.PosViewModule)}];let et=(()=>{class J{static#e=this.\u0275fac=function(de){return new(de||J)};static#t=this.\u0275mod=Q.$C({type:J});static#r=this.\u0275inj=Q.G2t({providers:[(0,re.Dw)()],imports:[we.MD,F.iI.forChild(Te),V.YN,V.X1]})}return J})(),le=(()=>{class J{static#e=this.\u0275fac=function(de){return new(de||J)};static#t=this.\u0275cmp=Q.VBU({type:J,selectors:[["lib-dashboard"]],decls:6,vars:0,consts:[[1,"row"],[1,"col-md-12",2,"padding","1vh"],[1,"card","shadow","mb-0"],[1,"card-header"],[1,"mb-0"]],template:function(de,Ue){1&de&&(Q.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),Q.EFF(5,"Statistik"),Q.k0s()()()()())}})}return J})(),je=(()=>{class J{static#e=this.\u0275fac=function(de){return new(de||J)};static#t=this.\u0275mod=Q.$C({type:J});static#r=this.\u0275inj=Q.G2t({imports:[we.MD,F.iI.forChild([{path:"",component:le}])]})}return J})(),tt=(()=>{class J{static#e=this.\u0275fac=function(de){return new(de||J)};static#t=this.\u0275cmp=Q.VBU({type:J,selectors:[["lib-persediaan"]],decls:2,vars:0,template:function(de,Ue){1&de&&(Q.j41(0,"p"),Q.EFF(1,"persediaan works!"),Q.k0s())}})}return J})(),Me=(()=>{class J{static#e=this.\u0275fac=function(de){return new(de||J)};static#t=this.\u0275mod=Q.$C({type:J});static#r=this.\u0275inj=Q.G2t({imports:[we.MD,F.iI.forChild([{path:"",component:tt}])]})}return J})();var xe=j(7469)},7469:(wt,Oe,j)=>{"use strict";j.d(Oe,{E:()=>V,X:()=>re});var we=j(4523),F=j(4096);class V extends F.Ay{constructor(){super("dbPOS"),this.version(3).stores({satuan:null,produk:"++id, barcode",konsumen:"++id",rekening:"++id, default",penjualan:"++id, no_faktur, tanggal, id_konsumen"}),this.on("populate",()=>this.populate())}populate(){return(0,we.A)(function*(){})()}}const re=new V},5505:function(wt){wt.exports=function(){"use strict";var Oe=function(e,t){return(Oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])})(e,t)},j=function(){return(j=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function we(e,t,r){if(r||2===arguments.length)for(var n,s=0,o=t.length;s<o;s++)!n&&s in t||((n=n||Array.prototype.slice.call(t,0,s))[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}var F=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,V=Object.keys,re=Array.isArray;function Q(e,t){return"object"!=typeof t||V(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||F.Promise||(F.Promise=Promise);var Te=Object.getPrototypeOf,et={}.hasOwnProperty;function le(e,t){return et.call(e,t)}function je(e,t){"function"==typeof t&&(t=t(Te(e))),(typeof Reflect>"u"?V:Reflect.ownKeys)(t).forEach(function(r){Me(e,r,t[r])})}var tt=Object.defineProperty;function Me(e,t,r,n){tt(e,t,Q(r&&le(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function xe(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Me(e.prototype,"constructor",e),{extend:je.bind(null,e.prototype)}}}}var J=Object.getOwnPropertyDescriptor,jt=[].slice;function Ae(e,t,r){return jt.call(e,t,r)}function de(e,t){return t(e)}function Ue(e){if(!e)throw new Error("Assertion Failed")}function Y(e){F.setImmediate?setImmediate(e):setTimeout(e,0)}function Ce(e,t){if("string"==typeof t&&le(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var r=[],n=0,s=t.length;n<s;++n){var o=Ce(e,t[n]);r.push(o)}return r}var c=t.indexOf(".");if(-1!==c){var u=e[t.substr(0,c)];return null==u?void 0:Ce(u,t.substr(c+1))}}function i(e,t,r){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){Ue("string"!=typeof r&&"length"in r);for(var n=0,s=t.length;n<s;++n)i(e,t[n],r[n])}else{var o,c,u=t.indexOf(".");-1!==u?(o=t.substr(0,u),""===(c=t.substr(u+1))?void 0===r?re(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=r:i(u=(u=e[o])&&le(e,o)?u:e[o]={},c,r)):void 0===r?re(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function a(e){var t,r={};for(t in e)le(e,t)&&(r[t]=e[t]);return r}var h=[].concat;function k(e){return h.apply([],e)}var We="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(k([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return F[e]}),E=new Set(We.map(function(e){return F[e]})),L=null;function w(e){return L=new WeakMap,e=function t(r){if(!r||"object"!=typeof r)return r;var n=L.get(r);if(n)return n;if(re(r)){L.set(r,n=[]);for(var s=0,o=r.length;s<o;++s)n.push(t(r[s]))}else if(E.has(r.constructor))n=r;else{var c,u=Te(r);for(c in n=u===Object.prototype?{}:Object.create(u),L.set(r,n),r)le(r,c)&&(n[c]=t(r[c]))}return n}(e),L=null,e}var O={}.toString;function q(e){return O.call(e).slice(8,-1)}var he=typeof Symbol<"u"?Symbol.iterator:"@@iterator",oe="symbol"==typeof he?function(e){var t;return null!=e&&(t=e[he])&&t.apply(e)}:function(){return null};function W(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}var ne={};function ae(e){var t,r,n,s;if(1===arguments.length){if(re(e))return e.slice();if(this===ne&&"string"==typeof e)return[e];if(s=oe(e)){for(r=[];!(n=s.next()).done;)r.push(n.value);return r}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var Ke=typeof Symbol<"u"?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},Ie=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(st=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),qe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ne(e,t){this.name=e,this.message=t}function He(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,n,s){return s.indexOf(r)===n}).join("\n")}function G(e,t,r,n){this.failures=t,this.failedKeys=n,this.successCount=r,this.message=He(e,t)}function B(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=He(e,this.failures)}xe(Ne).from(Error).extend({toString:function(){return this.name+": "+this.message}}),xe(G).from(Ne),xe(B).from(Ne);var ve=Ie.reduce(function(e,t){return e[t]=t+"Error",e},{}),fe=Ne,K=Ie.reduce(function(e,t){var r=t+"Error";function n(s,o){this.name=r,s?"string"==typeof s?(this.message="".concat(s).concat(o?"\n "+o:""),this.inner=o||null):"object"==typeof s&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=qe[t]||r,this.inner=null)}return xe(n).from(fe),e[t]=n,e},{});K.Syntax=SyntaxError,K.Type=TypeError,K.Range=RangeError;var Ee=st.reduce(function(e,t){return e[t+"Error"]=K[t],e},{}),Re=Ie.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=K[t]),e},{});function H(){}function ge(e){return e}function hr(e,t){return null==e||e===ge?t:function(r){return t(e(r))}}function ke(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function mt(e,t){return e===H?t:function(){var r=e.apply(this,arguments);void 0!==r&&(arguments[0]=r);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?ke(n,this.onsuccess):n),s&&(this.onerror=this.onerror?ke(s,this.onerror):s),void 0!==o?o:r}}function rt(e,t){return e===H?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?ke(r,this.onsuccess):r),n&&(this.onerror=this.onerror?ke(n,this.onerror):n)}}function xt(e,t){return e===H?t:function(r){var n=e.apply(this,arguments);Q(r,n);var s=this.onsuccess,o=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?ke(s,this.onsuccess):s),o&&(this.onerror=this.onerror?ke(o,this.onerror):o),void 0===n?void 0===r?void 0:r:Q(n,r)}}function Kt(e,t){return e===H?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function nt(e,t){return e===H?t:function(){var r=e.apply(this,arguments);if(r&&"function"==typeof r.then){for(var n=this,s=arguments.length,o=new Array(s);s--;)o[s]=arguments[s];return r.then(function(){return t.apply(n,o)})}return t.apply(this,arguments)}}Re.ModifyError=G,Re.DexieError=Ne,Re.BulkError=B;var De=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Rt(e){De=e}var st,it={},Ft=100,at=(Ie=(Ie=(We=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Te(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Te(t),e]}())[1])&&Ie.then,(st=We[0])&&st.constructor),fr=!!(We=We[2]),Ct=function(e,t){Mt.push([e,t]),Bt&&(queueMicrotask(En),Bt=!1)},dr=!0,Bt=!0,ot=[],$t=[],pr=ge,ze={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:H,pgp:!1,env:{},finalize:H},R=ze,Mt=[],ct=0,qt=[];function I(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=R;if("function"!=typeof e){if(e!==it)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&vr(this,this._value))}this._state=null,this._value=null,++t.ref,function r(n,s){try{s(function(o){if(null===n._state){if(o===n)throw new TypeError("A promise cannot be resolved with itself.");var c=n._lib&&vt();o&&"function"==typeof o.then?r(n,function(u,p){o instanceof I?o._then(u,p):o.then(u,p)}):(n._state=!0,n._value=o,Qr(n)),c&&gt()}},vr.bind(null,n))}catch(o){vr(n,o)}}(this,e)}var mr={get:function(){var e=R,t=Zt;function r(n,s){var o=this,c=!e.global&&(e!==R||t!==Zt),u=c&&!Ge(),p=new I(function(f,g){gr(o,new Gr(Vr(n,e,c,u),Vr(s,e,c,u),f,g,e))});return this._consoleTask&&(p._consoleTask=this._consoleTask),p}return r.prototype=it,r},set:function(e){Me(this,"then",e&&e.prototype===it?mr:{get:function(){return e},set:mr.set})}};function Gr(e,t,r,n,s){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=r,this.reject=n,this.psd=s}function vr(e,t){var r,n;$t.push(t),null===e._state&&(r=e._lib&&vt(),t=pr(t),e._state=!1,e._value=t,n=e,ot.some(function(s){return s._value===n._value})||ot.push(n),Qr(e),r&&gt())}function Qr(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)gr(e,t[r]);var s=e._PSD;--s.ref||s.finalize(),0===ct&&(++ct,Ct(function(){0==--ct&&yr()},[]))}function gr(e,t){if(null!==e._state){var r=e._state?t.onFulfilled:t.onRejected;if(null===r)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ct,Ct(Mn,[r,e,t])}else e._listeners.push(t)}function Mn(e,t,r){try{var n,s=t._value;!t._state&&$t.length&&($t=[]),n=De&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),t._state||-1!==$t.indexOf(s)||function(o){for(var c=ot.length;c;)if(ot[--c]._value===o._value)return ot.splice(c,1)}(t),r.resolve(n)}catch(o){r.reject(o)}finally{0==--ct&&yr(),--r.psd.ref||r.psd.finalize()}}function En(){ut(ze,function(){vt()&&gt()})}function vt(){var e=dr;return Bt=dr=!1,e}function gt(){var e,t,r;do{for(;0<Mt.length;)for(e=Mt,Mt=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}}while(0<Mt.length);Bt=dr=!0}function yr(){var e=ot;ot=[],e.forEach(function(n){n._PSD.onunhandled.call(null,n._value,n)});for(var t=qt.slice(0),r=t.length;r;)t[--r]()}function Ht(e){return new I(it,!1,e)}function se(e,t){var r=R;return function(){var n=vt(),s=R;try{return Qe(r,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{Qe(s,!1),n&&gt()}}}je(I.prototype,{then:mr,_then:function(e,t){gr(this,new Gr(null,null,e,t,R))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,r=arguments[1];return this.then(null,"function"==typeof t?function(n){return(n instanceof t?r:Ht)(n)}:function(n){return(n&&n.name===t?r:Ht)(n)})},finally:function(e){return this.then(function(t){return I.resolve(e()).then(function(){return t})},function(t){return I.resolve(e()).then(function(){return Ht(t)})})},timeout:function(e,t){var r=this;return e<1/0?new I(function(n,s){var o=setTimeout(function(){return s(new K.Timeout(t))},e);r.then(n,s).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Me(I.prototype,Symbol.toStringTag,"Dexie.Promise"),ze.env=Yr(),je(I,{all:function(){var e=ae.apply(null,arguments).map(Ut);return new I(function(t,r){0===e.length&&t([]);var n=e.length;e.forEach(function(s,o){return I.resolve(s).then(function(c){e[o]=c,--n||t(e)},r)})})},resolve:function(e){return e instanceof I?e:e&&"function"==typeof e.then?new I(function(t,r){e.then(t,r)}):new I(it,!0,e)},reject:Ht,race:function(){var e=ae.apply(null,arguments).map(Ut);return new I(function(t,r){e.map(function(n){return I.resolve(n).then(t,r)})})},PSD:{get:function(){return R},set:function(e){return R=e}},totalEchoes:{get:function(){return Zt}},newPSD:Xe,usePSD:ut,scheduler:{get:function(){return Ct},set:function(e){Ct=e}},rejectionMapper:{get:function(){return pr},set:function(e){pr=e}},follow:function(e,t){return new I(function(r,n){return Xe(function(s,o){var c=R;c.unhandleds=[],c.onunhandled=o,c.finalize=ke(function(){var u,p=this;u=function(){0===p.unhandleds.length?s():o(p.unhandleds[0])},qt.push(function f(){u(),qt.splice(qt.indexOf(f),1)}),++ct,Ct(function(){0==--ct&&yr()},[])},c.finalize),e()},t,r,n)})}}),at&&(at.allSettled&&Me(I,"allSettled",function(){var e=ae.apply(null,arguments).map(Ut);return new I(function(t){0===e.length&&t([]);var r=e.length,n=new Array(r);e.forEach(function(s,o){return I.resolve(s).then(function(c){return n[o]={status:"fulfilled",value:c}},function(c){return n[o]={status:"rejected",reason:c}}).then(function(){return--r||t(n)})})})}),at.any&&typeof AggregateError<"u"&&Me(I,"any",function(){var e=ae.apply(null,arguments).map(Ut);return new I(function(t,r){0===e.length&&r(new AggregateError([]));var n=e.length,s=new Array(n);e.forEach(function(o,c){return I.resolve(o).then(function(u){return t(u)},function(u){s[c]=u,--n||r(new AggregateError(s))})})})}));var pe={awaits:0,echoes:0,id:0},Pn=0,Lt=[],Wt=0,Zt=0,On=0;function Xe(e,t,r,n){var s=R,o=Object.create(s);return o.parent=s,o.ref=0,o.global=!1,o.id=++On,o.env=fr?{Promise:I,PromiseProp:{value:I,configurable:!0,writable:!0},all:I.all,race:I.race,allSettled:I.allSettled,any:I.any,resolve:I.resolve,reject:I.reject}:{},t&&Q(o,t),++s.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()},n=ut(o,e,r,n),0===o.ref&&o.finalize(),n}function yt(){return pe.id||(pe.id=++Pn),++pe.awaits,pe.echoes+=Ft,pe.id}function Ge(){return!!pe.awaits&&(0==--pe.awaits&&(pe.id=0),pe.echoes=pe.awaits*Ft,!0)}function Ut(e){return pe.echoes&&e&&e.constructor===at?(yt(),e.then(function(t){return Ge(),t},function(t){return Ge(),ce(t)})):e}function Tn(){var e=Lt[Lt.length-1];Lt.pop(),Qe(e,!1)}function Qe(e,t){var r,n=R;(t?!pe.echoes||Wt++&&e===R:!Wt||--Wt&&e===R)||queueMicrotask(t?function(s){++Zt,pe.echoes&&0!=--pe.echoes||(pe.echoes=pe.awaits=pe.id=0),Lt.push(R),Qe(s,!0)}.bind(null,e):Tn),e!==R&&(R=e,n===ze&&(ze.env=Yr()),fr&&(r=ze.env.Promise,t=e.env,(n.global||e.global)&&(Object.defineProperty(F,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function Yr(){var e=F.Promise;return fr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(F,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ut(e,t,r,n,s){var o=R;try{return Qe(e,!0),t(r,n,s)}finally{Qe(o,!1)}}function Vr(e,t,r,n){return"function"!=typeof e?e:function(){var s=R;r&&yt(),Qe(t,!0);try{return e.apply(this,arguments)}finally{Qe(s,!1),n&&queueMicrotask(Ge)}}}function _r(e){Promise===at&&0===pe.echoes?0===Wt?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+Ie).indexOf("[native code]")&&(yt=Ge=H);var ce=I.reject,Le="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Jr="String expected.",_t=[],zt="__dbnames",br="readonly",kr="readwrite";function ht(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var en={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Xt(e){return"string"!=typeof e||/\./.test(e)?function(t){return t}:function(t){return void 0===t[e]&&e in t&&delete(t=w(t))[e],t}}function tn(){throw K.Type()}function te(e,t){try{var r=rn(e),n=rn(t);if(r!==n)return"Array"===r?1:"Array"===n?-1:"binary"===r?1:"binary"===n?-1:"string"===r?1:"string"===n?-1:"Date"===r?1:"Date"!==n?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(s,o){for(var c=s.length,u=o.length,p=c<u?c:u,f=0;f<p;++f)if(s[f]!==o[f])return s[f]<o[f]?-1:1;return c===u?0:c<u?-1:1}(nn(e),nn(t));case"Array":return function(s,o){for(var c=s.length,u=o.length,p=c<u?c:u,f=0;f<p;++f){var g=te(s[f],o[f]);if(0!==g)return g}return c===u?0:c<u?-1:1}(e,t)}}catch{}return NaN}function rn(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=q(e))?"binary":e}function nn(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var sn=(ie.prototype._trans=function(e,t,r){var n=this._tx||R.trans,s=this.name,o=De&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function c(f,g,l){if(!l.schema[s])throw new K.NotFound("Table "+s+" not part of transaction");return t(l.idbtrans,l)}var u=vt();try{var p=n&&n.db._novip===this.db._novip?n===R.trans?n._promise(e,c,r):Xe(function(){return n._promise(e,c,r)},{trans:n,transless:R.transless||R}):function f(g,l,y,d){if(g.idbdb&&(g._state.openComplete||R.letThrough||g._vip)){var v=g._createTransaction(l,y,g._dbSchema);try{v.create(),g._state.PR1398_maxLoop=3}catch(_){return _.name===ve.InvalidState&&g.isOpen()&&0<--g._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),g.close({disableAutoOpen:!1}),g.open().then(function(){return f(g,l,y,d)})):ce(_)}return v._promise(l,function(_,m){return Xe(function(){return R.trans=v,d(_,m,v)})}).then(function(_){if("readwrite"===l)try{v.idbtrans.commit()}catch{}return"readonly"===l?_:v._completion.then(function(){return _})})}if(g._state.openComplete)return ce(new K.DatabaseClosed(g._state.dbOpenError));if(!g._state.isBeingOpened){if(!g._state.autoOpen)return ce(new K.DatabaseClosed);g.open().catch(H)}return g._state.dbReadyPromise.then(function(){return f(g,l,y,d)})}(this.db,e,[this.name],c);return o&&(p._consoleTask=o,p=p.catch(function(f){return console.trace(f),ce(f)})),p}finally{u&&gt()}},ie.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?ce(new K.Type("Invalid argument to Table.get()")):this._trans("readonly",function(n){return r.core.get({trans:n,key:e}).then(function(s){return r.hook.reading.fire(s)})}).then(t)},ie.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(re(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=V(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(p){if(p.compound&&t.every(function(g){return 0<=p.keyPath.indexOf(g)})){for(var f=0;f<t.length;++f)if(-1===t.indexOf(p.keyPath[f]))return!1;return!0}return!1}).sort(function(p,f){return p.keyPath.length-f.keyPath.length})[0];if(r&&"\uffff"!==this.db._maxKey){var c=r.keyPath.slice(0,t.length);return this.where(c).equals(c.map(function(f){return e[f]}))}!r&&De&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var n=this.schema.idxByName,s=this.db._deps.indexedDB;function o(p,f){return 0===s.cmp(p,f)}c=(u=t.reduce(function(y,f){var g=y[0],l=y[1],d=(y=n[f],e[f]);return[g||y,g||!y?ht(l,y&&y.multi?function(v){return v=Ce(v,f),re(v)&&v.some(function(_){return o(d,_)})}:function(v){return o(d,Ce(v,f))}):l]},[null,null]))[0];var u=u[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(u):r?this.filter(u):this.where(t).equals("")},ie.prototype.filter=function(e){return this.toCollection().and(e)},ie.prototype.count=function(e){return this.toCollection().count(e)},ie.prototype.offset=function(e){return this.toCollection().offset(e)},ie.prototype.limit=function(e){return this.toCollection().limit(e)},ie.prototype.each=function(e){return this.toCollection().each(e)},ie.prototype.toArray=function(e){return this.toCollection().toArray(e)},ie.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ie.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,re(e)?"[".concat(e.join("+"),"]"):e))},ie.prototype.reverse=function(){return this.toCollection().reverse()},ie.prototype.mapToClass=function(e){var t,r=this.db,n=this.name;function s(){return null!==t&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof tn&&(function(p,f){if("function"!=typeof f&&null!==f)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function g(){this.constructor=p}Oe(p,f),p.prototype=null===f?Object.create(f):(g.prototype=f.prototype,new g)}(s,t=e),Object.defineProperty(s.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),s.prototype.table=function(){return n},e=s);for(var o=new Set,c=e.prototype;c;c=Te(c))Object.getOwnPropertyNames(c).forEach(function(p){return o.add(p)});function u(p){if(!p)return p;var f,g=Object.create(e.prototype);for(f in p)if(!o.has(f))try{g[f]=p[f]}catch{}return g}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),e},ie.prototype.defineClass=function(){return this.mapToClass(function(e){Q(this,e)})},ie.prototype.add=function(e,t){var r=this,n=this.schema.primKey,o=n.keyPath,c=e;return o&&n.auto&&(c=Xt(o)(e)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"add",keys:null!=t?[t]:null,values:[c]})}).then(function(u){return u.numFailures?I.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{i(e,o,u)}catch{}return u})},ie.prototype.update=function(e,t){return"object"!=typeof e||re(e)?this.where(":id").equals(e).modify(t):void 0===(e=Ce(e,this.schema.primKey.keyPath))?ce(new K.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},ie.prototype.put=function(e,t){var r=this,n=this.schema.primKey,o=n.keyPath,c=e;return o&&n.auto&&(c=Xt(o)(e)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"put",values:[c],keys:null!=t?[t]:null})}).then(function(u){return u.numFailures?I.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{i(e,o,u)}catch{}return u})},ie.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?I.reject(r.failures[0]):void 0})},ie.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:en})}).then(function(t){return t.numFailures?I.reject(t.failures[0]):void 0})},ie.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(n){return n.map(function(s){return t.hook.reading.fire(s)})})})},ie.prototype.bulkAdd=function(e,t,r){var n=this,s=Array.isArray(t)?t:void 0,o=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(c){var u=(f=n.schema.primKey).auto;if((f=f.keyPath)&&s)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var p=e.length,f=f&&u?e.map(Xt(f)):e;return n.core.mutate({trans:c,type:"add",keys:s,values:f,wantResults:o}).then(function(v){var l=v.numFailures,y=v.results,d=v.lastResult;if(v=v.failures,0===l)return o?y:d;throw new B("".concat(n.name,".bulkAdd(): ").concat(l," of ").concat(p," operations failed"),v)})})},ie.prototype.bulkPut=function(e,t,r){var n=this,s=Array.isArray(t)?t:void 0,o=(r=r||(s?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(c){var u=(f=n.schema.primKey).auto;if((f=f.keyPath)&&s)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var p=e.length,f=f&&u?e.map(Xt(f)):e;return n.core.mutate({trans:c,type:"put",keys:s,values:f,wantResults:o}).then(function(v){var l=v.numFailures,y=v.results,d=v.lastResult;if(v=v.failures,0===l)return o?y:d;throw new B("".concat(n.name,".bulkPut(): ").concat(l," of ").concat(p," operations failed"),v)})})},ie.prototype.bulkUpdate=function(e){var t=this,r=this.core,n=e.map(function(c){return c.key}),s=e.map(function(c){return c.changes}),o=[];return this._trans("readwrite",function(c){return r.getMany({trans:c,keys:n,cache:"clone"}).then(function(u){var p=[],f=[];e.forEach(function(l,y){var d=l.key,v=l.changes,_=u[y];if(_){for(var m=0,b=Object.keys(v);m<b.length;m++){var S=b[m],x=v[S];if(S===t.schema.primKey.keyPath){if(0!==te(x,d))throw new K.Constraint("Cannot update primary key in bulkUpdate()")}else i(_,S,x)}o.push(y),p.push(d),f.push(_)}});var g=p.length;return r.mutate({trans:c,type:"put",keys:p,values:f,updates:{keys:n,changeSpecs:s}}).then(function(l){var y=l.numFailures,d=l.failures;if(0===y)return g;for(var v=0,_=Object.keys(d);v<_.length;v++){var m,b=_[v],S=o[Number(b)];null!=S&&(m=d[b],delete d[b],d[S]=m)}throw new B("".concat(t.name,".bulkUpdate(): ").concat(y," of ").concat(g," operations failed"),d)})})})},ie.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:e})}).then(function(c){var s=c.numFailures,o=c.lastResult;if(c=c.failures,0===s)return o;throw new B("".concat(t.name,".bulkDelete(): ").concat(s," of ").concat(r," operations failed"),c)})},ie);function ie(){}function Et(e){function t(c,u){if(u){for(var p=arguments.length,f=new Array(p-1);--p;)f[p-1]=arguments[p];return r[c].subscribe.apply(null,f),e}if("string"==typeof c)return r[c]}var r={};t.addEventType=o;for(var n=1,s=arguments.length;n<s;++n)o(arguments[n]);return t;function o(c,u,p){if("object"!=typeof c){var f;u=u||Kt;var g={subscribers:[],fire:p=p||H,subscribe:function(l){-1===g.subscribers.indexOf(l)&&(g.subscribers.push(l),g.fire=u(g.fire,l))},unsubscribe:function(l){g.subscribers=g.subscribers.filter(function(y){return y!==l}),g.fire=g.subscribers.reduce(u,p)}};return r[c]=t[c]=g}V(f=c).forEach(function(l){var y=f[l];if(re(y))o(l,f[l][0],f[l][1]);else{if("asap"!==y)throw new K.InvalidArgument("Invalid event config");var d=o(l,ge,function(){for(var v=arguments.length,_=new Array(v);v--;)_[v]=arguments[v];d.subscribers.forEach(function(m){Y(function(){m.apply(null,_)})})})}})}}function Pt(e,t){return xe(t).from({prototype:e}),t}function bt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Sr(e,t){e.filter=ht(e.filter,t)}function wr(e,t,r){var n=e.replayFilter;e.replayFilter=n?function(){return ht(n(),t())}:t,e.justLimit=r&&!n}function Gt(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new K.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function an(e,t,r){var n=Gt(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:n,range:e.range}})}function Qt(e,t,r,n){var s=e.replayFilter?ht(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},c=function(u,p,f){var g,l;s&&!s(p,f,function(y){return p.stop(y)},function(y){return p.fail(y)})||("[object ArrayBuffer]"==(l=""+(g=p.primaryKey))&&(l=""+new Uint8Array(g)),le(o,l)||(o[l]=!0,t(u,p,f)))};return Promise.all([e.or._iterate(c,r),on(an(e,n,r),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return on(an(e,n,r),ht(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function on(e,t,r,n){var s=se(n?function(o,c,u){return r(n(o),c,u)}:r);return e.then(function(o){if(o)return o.start(function(){var c=function(){return o.continue()};t&&!t(o,function(u){return c=u},function(u){o.stop(u),c=H},function(u){o.fail(u),c=H})||s(o.value,o,function(u){return c=u}),c()})})}We=Symbol();var xr=(cn.prototype.execute=function(e){var t=null===(t=this.replacePrefix)||void 0===t?void 0:t[0];return t&&"string"==typeof e&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},cn);function cn(e){Object.assign(this,e)}var An=(ee.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,ce.bind(null,r.error)):r.table._trans("readonly",e).then(t)},ee.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,ce.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ee.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=ht(t.algorithm,e)},ee.prototype._iterate=function(e,t){return Qt(this._ctx,e,t,this._ctx.table.core)},ee.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Q(r,e),t._ctx=r,t},ee.prototype.raw=function(){return this._ctx.valueMapper=null,this},ee.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return Qt(t,e,r,t.table.core)})},ee.prototype.count=function(e){var t=this;return this._read(function(r){var n=t._ctx,s=n.table.core;if(bt(n,!0))return s.count({trans:r,query:{index:Gt(n,s.schema),range:n.range}}).then(function(c){return Math.min(c,n.limit)});var o=0;return Qt(n,function(){return++o,!1},r,s).then(function(){return o})}).then(e)},ee.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),n=r[0],s=r.length-1;function o(p,f){return f?o(p[r[f]],f-1):p[n]}var c="next"===this._ctx.dir?1:-1;function u(p,f){return(p=o(p,s))<(f=o(f,s))?-c:f<p?c:0}return this.toArray(function(p){return p.sort(u)}).then(t)},ee.prototype.toArray=function(e){var t=this;return this._read(function(r){var n=t._ctx;if("next"===n.dir&&bt(n,!0)&&0<n.limit){var s=n.valueMapper,o=Gt(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then(function(u){return u=u.result,s?u.map(s):u})}var c=[];return Qt(n,function(u){return c.push(u)},r,n.table.core).then(function(){return c})},e)},ee.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,bt(t)?wr(t,function(){var r=e;return function(n,s){return 0===r||(1===r?--r:s(function(){n.advance(r),r=0}),!1)}}):wr(t,function(){var r=e;return function(){return--r<0}})),this},ee.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),wr(this._ctx,function(){var t=e;return function(r,n,s){return--t<=0&&n(s),0<=t}},!0),this},ee.prototype.until=function(e,t){return Sr(this._ctx,function(r,n,s){return!e(r.value)||(n(s),t)}),this},ee.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ee.prototype.last=function(e){return this.reverse().first(e)},ee.prototype.filter=function(e){var t;return Sr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=ht(t.isMatch,e),this},ee.prototype.and=function(e){return this.filter(e)},ee.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ee.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ee.prototype.desc=function(){return this.reverse()},ee.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,n){e(n.key,n)})},ee.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ee.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,n){e(n.primaryKey,n)})},ee.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(n,s){r.push(s.key)}).then(function(){return r}).then(e)},ee.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&bt(t,!0)&&0<t.limit)return this._read(function(n){var s=Gt(t,t.table.core.schema);return t.table.core.query({trans:n,values:!1,limit:t.limit,query:{index:s,range:t.range}})}).then(function(n){return n.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(n,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)},ee.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ee.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ee.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ee.prototype.distinct=function(){var e;if(!(e=(e=this._ctx).index&&e.table.schema.idxByName[e.index])||!e.multi)return this;var t={};return Sr(this._ctx,function(s){var n=s.primaryKey.toString();return s=le(t,n),t[n]=!0,!s}),this},ee.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(n){var s,o,c;function u(m,x){var S=x.failures;v+=m-(x=x.numFailures);for(var C=0,M=V(S);C<M.length;C++)d.push(S[M[C]])}c="function"==typeof e?e:(s=V(e),o=s.length,function(m){for(var b=!1,S=0;S<o;++S){var x=s[S],C=e[x],M=Ce(m,x);C instanceof xr?(i(m,x,C.execute(M)),b=!0):M!==C&&(i(m,x,C),b=!0)}return b});var p=r.table.core,f=p.schema.primaryKey,g=f.outbound,l=f.extractKey,y=t.db._options.modifyChunkSize||200,d=[],v=0,_=[];return t.clone().primaryKeys().then(function(m){return function b(S){var x=Math.min(y,m.length-S);return p.getMany({trans:n,keys:m.slice(S,S+x),cache:"immutable"}).then(function(C){for(var M=[],A=[],P=g?[]:null,T=[],N=0;N<x;++N){var D=C[N],$={value:w(D),primKey:m[S+N]};!1!==c.call($,$.value,$)&&(null==$.value?T.push(m[S+N]):g||0===te(l(D),l($.value))?(A.push($.value),g&&P.push(m[S+N])):(T.push(m[S+N]),M.push($.value)))}var Z=bt(r)&&r.limit===1/0&&("function"!=typeof e||e===Cr)&&{index:r.index,range:r.range};return Promise.resolve(0<M.length&&p.mutate({trans:n,type:"add",values:M}).then(function(X){for(var U in X.failures)T.splice(parseInt(U),1);u(M.length,X)})).then(function(){return(0<A.length||Z&&"object"==typeof e)&&p.mutate({trans:n,type:"put",keys:P,values:A,criteria:Z,changeSpec:"function"!=typeof e&&e}).then(function(X){return u(A.length,X)})}).then(function(){return(0<T.length||Z&&e===Cr)&&p.mutate({trans:n,type:"delete",keys:T,criteria:Z}).then(function(X){return u(T.length,X)})}).then(function(){return m.length>S+x&&b(S+y)})})}(0).then(function(){if(0<d.length)throw new G("Error modifying one or more objects",d,v,_);return m.length})})})},ee.prototype.delete=function(){var e=this._ctx,t=e.range;return bt(e)&&(e.isPrimKey||3===t.type)?this._write(function(r){var s=t;return e.table.core.count({trans:r,query:{index:e.table.core.schema.primaryKey,range:s}}).then(function(o){return e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(function(c){var u=c.failures;if(c=c.numFailures)throw new G("Could not delete some values",Object.keys(u).map(function(p){return u[p]}),o-c);return o-c})})}):this.modify(Cr)},ee);function ee(){}var Cr=function(e,t){return t.value=null};function Nn(e,t){return e<t?-1:e===t?0:1}function Dn(e,t){return t<e?-1:e===t?0:1}function Pe(e,t,r){return(e=e instanceof ln?new e.Collection(e):e)._ctx.error=new(r||TypeError)(t),e}function kt(e){return new e.Collection(e,function(){return un("")}).limit(0)}function Yt(e,t,r,n){var s,o,c,u,p,f,g,l=r.length;if(!r.every(function(v){return"string"==typeof v}))return Pe(e,Jr);function y(v){s="next"===v?function(m){return m.toUpperCase()}:function(m){return m.toLowerCase()},o="next"===v?function(m){return m.toLowerCase()}:function(m){return m.toUpperCase()},c="next"===v?Nn:Dn;var _=r.map(function(m){return{lower:o(m),upper:s(m)}}).sort(function(m,b){return c(m.lower,b.lower)});u=_.map(function(m){return m.upper}),p=_.map(function(m){return m.lower}),g="next"===(f=v)?"":n}y("next"),(e=new e.Collection(e,function(){return Ye(u[0],p[l-1]+n)}))._ondirectionchange=function(v){y(v)};var d=0;return e._addAlgorithm(function(v,_,m){var b=v.key;if("string"!=typeof b)return!1;var S=o(b);if(t(S,p,d))return!0;for(var x=null,C=d;C<l;++C){var M=function(A,P,T,N,D,$){for(var Z=Math.min(A.length,N.length),X=-1,U=0;U<Z;++U){var Fe=P[U];if(Fe!==N[U])return D(A[U],T[U])<0?A.substr(0,U)+T[U]+T.substr(U+1):D(A[U],N[U])<0?A.substr(0,U)+N[U]+T.substr(U+1):0<=X?A.substr(0,X)+P[X]+T.substr(X+1):null;D(A[U],Fe)<0&&(X=U)}return Z<N.length&&"next"===$?A+T.substr(A.length):Z<A.length&&"prev"===$?A.substr(0,T.length):X<0?null:A.substr(0,X)+N[X]+T.substr(X+1)}(b,S,u[C],p[C],c,f);null===M&&null===x?d=C+1:(null===x||0<c(x,M))&&(x=M)}return _(null!==x?function(){v.continue(x+g)}:m),!1}),e}function Ye(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function un(e){return{type:1,lower:e,upper:e}}var ln=(Object.defineProperty(me.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),me.prototype.between=function(e,t,r,n){r=!1!==r,n=!0===n;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(r||n)&&(!r||!n)?kt(this):new this.Collection(this,function(){return Ye(e,t,!r,!n)})}catch{return Pe(this,Le)}},me.prototype.equals=function(e){return null==e?Pe(this,Le):new this.Collection(this,function(){return un(e)})},me.prototype.above=function(e){return null==e?Pe(this,Le):new this.Collection(this,function(){return Ye(e,void 0,!0)})},me.prototype.aboveOrEqual=function(e){return null==e?Pe(this,Le):new this.Collection(this,function(){return Ye(e,void 0,!1)})},me.prototype.below=function(e){return null==e?Pe(this,Le):new this.Collection(this,function(){return Ye(void 0,e,!1,!0)})},me.prototype.belowOrEqual=function(e){return null==e?Pe(this,Le):new this.Collection(this,function(){return Ye(void 0,e)})},me.prototype.startsWith=function(e){return"string"!=typeof e?Pe(this,Jr):this.between(e,e+"\uffff",!0,!0)},me.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Yt(this,function(t,r){return 0===t.indexOf(r[0])},[e],"\uffff")},me.prototype.equalsIgnoreCase=function(e){return Yt(this,function(t,r){return t===r[0]},[e],"")},me.prototype.anyOfIgnoreCase=function(){var e=ae.apply(ne,arguments);return 0===e.length?kt(this):Yt(this,function(t,r){return-1!==r.indexOf(t)},e,"")},me.prototype.startsWithAnyOfIgnoreCase=function(){var e=ae.apply(ne,arguments);return 0===e.length?kt(this):Yt(this,function(t,r){return r.some(function(n){return 0===t.indexOf(n)})},e,"\uffff")},me.prototype.anyOf=function(){var e=this,t=ae.apply(ne,arguments),r=this._cmp;try{t.sort(r)}catch{return Pe(this,Le)}if(0===t.length)return kt(this);var n=new this.Collection(this,function(){return Ye(t[0],t[t.length-1])});n._ondirectionchange=function(o){t.sort(r="next"===o?e._ascending:e._descending)};var s=0;return n._addAlgorithm(function(o,c,u){for(var p=o.key;0<r(p,t[s]);)if(++s===t.length)return c(u),!1;return 0===r(p,t[s])||(c(function(){o.continue(t[s])}),!1)}),n},me.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},me.prototype.noneOf=function(){var e=ae.apply(ne,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Pe(this,Le)}var t=e.reduce(function(r,n){return r?r.concat([[r[r.length-1][1],n]]):[[-1/0,n]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},me.prototype.inAnyRange=function(b,t){var r=this,n=this._cmp,s=this._ascending,o=this._descending,c=this._min,u=this._max;if(0===b.length)return kt(this);if(!b.every(function(S){return void 0!==S[0]&&void 0!==S[1]&&s(S[0],S[1])<=0}))return Pe(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);var g,p=!t||!1!==t.includeLowers,f=t&&!0===t.includeUppers,l=s;function y(S,x){return l(S[0],x[0])}try{(g=b.reduce(function(S,x){for(var C=0,M=S.length;C<M;++C){var A=S[C];if(n(x[0],A[1])<0&&0<n(x[1],A[0])){A[0]=c(A[0],x[0]),A[1]=u(A[1],x[1]);break}}return C===M&&S.push(x),S},[])).sort(y)}catch{return Pe(this,Le)}var d=0,v=f?function(S){return 0<s(S,g[d][1])}:function(S){return 0<=s(S,g[d][1])},_=p?function(S){return 0<o(S,g[d][0])}:function(S){return 0<=o(S,g[d][0])},m=v;return(b=new this.Collection(this,function(){return Ye(g[0][0],g[g.length-1][1],!p,!f)}))._ondirectionchange=function(S){l="next"===S?(m=v,s):(m=_,o),g.sort(y)},b._addAlgorithm(function(S,x,C){for(var M,A=S.key;m(A);)if(++d===g.length)return x(C),!1;return!v(M=A)&&!_(M)||(0===r._cmp(A,g[d][1])||0===r._cmp(A,g[d][0])||x(function(){S.continue(l===s?g[d][0]:g[d][1])}),!1)}),b},me.prototype.startsWithAnyOf=function(){var e=ae.apply(ne,arguments);return e.every(function(t){return"string"==typeof t})?0===e.length?kt(this):this.inAnyRange(e.map(function(t){return[t,t+"\uffff"]})):Pe(this,"startsWithAnyOf() only works with strings")},me);function me(){}function Be(e){return se(function(t){return Ot(t),e(t.target.error),!1})}function Ot(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Tt="storagemutated",Mr="x-storagemutated-1",Ve=Et(null,Tt),In=($e.prototype._lock=function(){return Ue(!R.global),++this._reculock,1!==this._reculock||R.global||(R.lockOwnerFor=this),this},$e.prototype._unlock=function(){if(Ue(!R.global),0==--this._reculock)for(R.global||(R.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{ut(e[1],e[0])}catch{}}return this},$e.prototype._locked=function(){return this._reculock&&R.lockOwnerFor!==this},$e.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,n=this.db._state.dbOpenError;if(Ue(!this.idbtrans),!e&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new K.DatabaseClosed(n);case"MissingAPIError":throw new K.MissingAPI(n.message,n);default:throw new K.OpenFailed(n)}if(!this.active)throw new K.TransactionInactive;return Ue(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=se(function(s){Ot(s),t._reject(e.error)}),e.onabort=se(function(s){Ot(s),t.active&&t._reject(new K.Abort(e.error)),t.active=!1,t.on("abort").fire(s)}),e.oncomplete=se(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Ve.storagemutated.fire(e.mutatedParts)}),this},$e.prototype._promise=function(e,t,r){var n=this;if("readwrite"===e&&"readwrite"!==this.mode)return ce(new K.ReadOnly("Transaction is readonly"));if(!this.active)return ce(new K.TransactionInactive);if(this._locked())return new I(function(o,c){n._blockedFuncs.push([function(){n._promise(e,t,r).then(o,c)},R])});if(r)return Xe(function(){var o=new I(function(c,u){n._lock();var p=t(c,u,n);p&&p.then&&p.then(c,u)});return o.finally(function(){return n._unlock()}),o._lib=!0,o});var s=new I(function(o,c){var u=t(o,c,n);u&&u.then&&u.then(o,c)});return s._lib=!0,s},$e.prototype._root=function(){return this.parent?this.parent._root():this},$e.prototype.waitFor=function(e){var t,r=this._root(),n=I.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return n}):(r._waitingFor=n,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function o(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=o)}());var s=r._waitingFor;return new I(function(o,c){n.then(function(u){return r._waitingQueue.push(se(o.bind(null,u)))},function(u){return r._waitingQueue.push(se(c.bind(null,u)))}).finally(function(){r._waitingFor===s&&(r._waitingFor=null)})})},$e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))},$e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(le(t,e))return t[e];var r=this.schema[e];if(!r)throw new K.NotFound("Table "+e+" not part of transaction");return(r=new this.db.Table(e,r,this)).core=this.db.core.table(e),t[e]=r},$e);function $e(){}function Er(e,t,r,n,s,o,c){return{name:e,keyPath:t,unique:r,multi:n,auto:s,compound:o,src:(r&&!c?"&":"")+(n?"*":"")+(s?"++":"")+hn(t)}}function hn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Pr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(n=function(s){return[s.name,s]},r.reduce(function(s,o,c){return(c=n(o))&&(s[c[0]]=c[1]),s},{}))};var n}var At=function(e){try{return e.only([[]]),At=function(){return[[]]},[[]]}catch{return At=function(){return"\uffff"},"\uffff"}};function Or(e){return null==e?function(){}:"string"==typeof e?1===(t=e).split(".").length?function(r){return r[t]}:function(r){return Ce(r,t)}:function(r){return Ce(r,e)};var t}function fn(e){return[].slice.call(e)}var jn=0;function Nt(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Kn(e,t,p){function n(m){if(3===m.type)return null;if(4===m.type)throw new Error("Cannot convert never type to IDBKeyRange");var d=m.lower,v=m.upper,_=m.lowerOpen;return m=m.upperOpen,void 0===d?void 0===v?null:t.upperBound(v,!!m):void 0===v?t.lowerBound(d,!!_):t.bound(d,v,!!_,!!m)}var o,c,u,f=(c=p,u=fn((o=e).objectStoreNames),g={schema:{name:o.name,tables:u.map(function(y){return c.objectStore(y)}).map(function(y){var d=y.keyPath,m=y.autoIncrement,v=re(d),_={};return m={name:y.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==d,compound:v,keyPath:d,autoIncrement:m,unique:!0,extractKey:Or(d)},indexes:fn(y.indexNames).map(function(b){return y.index(b)}).map(function(C){var x=C.unique,M=C.multiEntry;return M={name:C.name,compound:re(C=C.keyPath),keyPath:C,unique:x,multiEntry:M,extractKey:Or(C)},_[Nt(C)]=M}),getIndexByKeyPath:function(b){return _[Nt(b)]}},_[":id"]=m.primaryKey,null!=d&&(_[Nt(d)]=m.primaryKey),m})},hasGetAll:0<u.length&&"getAll"in c.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}).hasGetAll,g=(p=g.schema).tables.map(function s(y){var d,v=y.name;return{name:v,schema:y,mutate:function(_){var m=_.trans,b=_.type,S=_.keys,x=_.values,C=_.range;return new Promise(function(M,A){M=se(M);var P=m.objectStore(v),T=null==P.keyPath,N="put"===b||"add"===b;if(!N&&"delete"!==b&&"deleteRange"!==b)throw new Error("Invalid operation type: "+b);var D,$=(S||x||{length:1}).length;if(S&&x&&S.length!==x.length)throw new Error("Given keys array must have same length as given values array.");if(0===$)return M({numFailures:0,failures:{},results:[],lastResult:void 0});function Z(Se){++Fe,Ot(Se)}var X=[],U=[],Fe=0;if("deleteRange"===b){if(4===C.type)return M({numFailures:Fe,failures:U,results:[],lastResult:void 0});X.push(D=3===C.type?P.clear():P.delete(n(C)))}else{var z=(T=N?T?[x,S]:[x,null]:[S,null])[0],_e=T[1];if(N)for(var be=0;be<$;++be)X.push(D=_e&&void 0!==_e[be]?P[b](z[be],_e[be]):P[b](z[be])),D.onerror=Z;else for(be=0;be<$;++be)X.push(D=P[b](z[be])),D.onerror=Z}function lr(Se){Se=Se.target.result,X.forEach(function(pt,Xr){return null!=pt.error&&(U[Xr]=pt.error)}),M({numFailures:Fe,failures:U,results:"delete"===b?S:X.map(function(pt){return pt.result}),lastResult:Se})}D.onerror=function(Se){Z(Se),lr(Se)},D.onsuccess=lr})},getMany:function(_){var m=_.trans,b=_.keys;return new Promise(function(S,x){S=se(S);for(var C,M=m.objectStore(v),A=b.length,P=new Array(A),T=0,N=0,D=function(X){P[(X=X.target)._pos]=X.result,++N===T&&S(P)},$=Be(x),Z=0;Z<A;++Z)null!=b[Z]&&((C=M.get(b[Z]))._pos=Z,C.onsuccess=D,C.onerror=$,++T);0===T&&S(P)})},get:function(_){var m=_.trans,b=_.key;return new Promise(function(S,x){S=se(S);var C=m.objectStore(v).get(b);C.onsuccess=function(M){return S(M.target.result)},C.onerror=Be(x)})},query:(d=f,function(_){return new Promise(function(m,b){m=se(m);var S,x,C,M=_.values,A=_.limit,P=A===1/0?void 0:A,N=(D=_.query).index,D=D.range,T=(T=_.trans).objectStore(v);if(N=N.isPrimaryKey?T:T.index(N.name),D=n(D),0===A)return m({result:[]});d?((P=M?N.getAll(D,P):N.getAllKeys(D,P)).onsuccess=function($){return m({result:$.target.result})},P.onerror=Be(b)):(S=0,x=!M&&"openKeyCursor"in N?N.openKeyCursor(D):N.openCursor(D),C=[],x.onsuccess=function($){var Z=x.result;return Z?(C.push(M?Z.value:Z.primaryKey),++S===A?m({result:C}):void Z.continue()):m({result:C})},x.onerror=Be(b))})}),openCursor:function(_){var m=_.trans,b=_.values,S=_.query,x=_.reverse,C=_.unique;return new Promise(function(M,A){M=se(M);var N=S.index,P=S.range,T=m.objectStore(v),D=(T=N.isPrimaryKey?T:T.index(N.name),N=x?C?"prevunique":"prev":C?"nextunique":"next",!b&&"openKeyCursor"in T?T.openKeyCursor(n(P),N):T.openCursor(n(P),N));D.onerror=Be(A),D.onsuccess=se(function($){var Z,X,U,Fe,z=D.result;z?(z.___id=++jn,z.done=!1,Z=z.continue.bind(z),X=(X=z.continuePrimaryKey)&&X.bind(z),U=z.advance.bind(z),Fe=function(){throw new Error("Cursor not stopped")},z.trans=m,z.stop=z.continue=z.continuePrimaryKey=z.advance=function(){throw new Error("Cursor not started")},z.fail=se(A),z.next=function(){var _e=this,be=1;return this.start(function(){return be--?_e.continue():_e.stop()}).then(function(){return _e})},z.start=function(_e){function be(){if(D.result)try{_e()}catch(Se){z.fail(Se)}else z.done=!0,z.start=function(){throw new Error("Cursor behind last entry")},z.stop()}var lr=new Promise(function(Se,pt){Se=se(Se),D.onerror=Be(pt),z.fail=pt,z.stop=function(Xr){z.stop=z.continue=z.continuePrimaryKey=z.advance=Fe,Se(Xr)}});return D.onsuccess=se(function(Se){D.onsuccess=be,be()}),z.continue=Z,z.continuePrimaryKey=X,z.advance=U,be(),lr},M(z)):M(null)},A)})},count:function(_){var m=_.query,b=_.trans,S=m.index,x=m.range;return new Promise(function(C,M){var A=b.objectStore(v),P=S.isPrimaryKey?A:A.index(S.name);(P=(A=n(x))?P.count(A):P.count()).onsuccess=se(function(T){return C(T.target.result)}),P.onerror=Be(M)})}}}),l={};return g.forEach(function(y){return l[y.name]=y}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(y){if(!l[y])throw new Error("Table '".concat(y,"' not found"));return l[y]},MIN_KEY:-1/0,MAX_KEY:At(t),schema:p}}function Vt(e,n){n=function Rn(e,t,r,n){return{dbcore:(n=Kn(t,r.IDBKeyRange,n),e.dbcore.reduce(function(o,c){return c=c.create,j(j({},o),c(o))},n))}}(e._middlewares,n.db,e._deps,n),e.core=n.dbcore,e.tables.forEach(function(s){var o=s.name;e.core.schema.tables.some(function(c){return c.name===o})&&(s.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=s.core))})}function Jt(e,t,r,n){r.forEach(function(s){var o=n[s];t.forEach(function(c){var u=function p(f,g){return J(f,g)||(f=Te(f))&&p(f,g)}(c,s);(!u||"value"in u&&void 0===u.value)&&(c===e.Transaction.prototype||c instanceof e.Transaction?Me(c,s,{get:function(){return this.table(s)},set:function(p){tt(this,s,{value:p,writable:!0,configurable:!0,enumerable:!0})}}):c[s]=new e.Table(s,o))})})}function Tr(e,t){t.forEach(function(r){for(var n in r)r[n]instanceof e.Table&&delete r[n]})}function Fn(e,t){return e._cfg.version-t._cfg.version}function Ar(e,t){var r,n={del:[],add:[],change:[]};for(r in e)t[r]||n.del.push(r);for(r in t){var s=e[r],o=t[r];if(s){var c={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||s.primKey.auto!==o.primKey.auto)c.recreate=!0,n.change.push(c);else{var u=s.idxByName,p=o.idxByName,f=void 0;for(f in u)p[f]||c.del.push(f);for(f in p){var g=u[f],l=p[f];g?g.src!==l.src&&c.change.push(l):c.add.push(l)}(0<c.del.length||0<c.add.length||0<c.change.length)&&n.change.push(c)}}else n.add.push([r,o])}return n}function Nr(e,t,r,n){var s=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(function(o){return er(s,o)}),s}function dn(e,t){V(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(De&&console.debug("Dexie: Creating missing table",r),Nr(t,r,e[r].primKey,e[r].indexes))})}function er(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function tr(e,t,r){var n={};return Ae(t.objectStoreNames,0).forEach(function(s){for(var o=r.objectStore(s),c=Er(hn(f=o.keyPath),f||"",!0,!1,!!o.autoIncrement,f&&"string"!=typeof f,!0),u=[],p=0;p<o.indexNames.length;++p){var f=(g=o.index(o.indexNames[p])).keyPath,g=Er(g.name,f,!!g.unique,!!g.multiEntry,!1,f&&"string"!=typeof f,!1);u.push(g)}n[s]=Pr(s,c,u)}),n}function rr(e,t,r){for(var n=r.db.objectStoreNames,s=0;s<n.length;++s){var o=n[s],c=r.objectStore(o);e._hasGetAll="getAll"in c;for(var u=0;u<c.indexNames.length;++u){var p=c.indexNames[u],f=c.index(p).keyPath,g="string"==typeof f?f:"["+Ae(f).join("+")+"]";!t[o]||(f=t[o].idxByName[g])&&(f.name=p,delete t[o].idxByName[g],t[o].idxByName[p]=f)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&F.WorkerGlobalScope&&F instanceof F.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function pn(e){return e.split(",").map(function(t,r){var n=(t=t.trim()).replace(/([&*]|\+\+)/g,""),s=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Er(n,s||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),re(s),0===r)})}var qn=(nr.prototype._parseStoresSpec=function(e,t){V(e).forEach(function(r){if(null!==e[r]){var n=pn(e[r]),s=n.shift();if(s.unique=!0,s.multi)throw new K.Schema("Primary key cannot be multi-valued");n.forEach(function(o){if(o.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),t[r]=Pr(r,s,n)}})},nr.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?Q(this._cfg.storesSource,r):r;var n={},s={};return(r=t._versions).forEach(function(o){Q(n,o._cfg.storesSource),s=o._cfg.dbschema={},o._parseStoresSpec(n,s)}),t._dbSchema=s,Tr(t,[t._allTables,t,t.Transaction.prototype]),Jt(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],V(s),s),t._storeNames=V(s),this},nr.prototype.upgrade=function(e){return this._cfg.contentUpgrade=nt(this._cfg.contentUpgrade||H,e),this},nr);function nr(){}function Dr(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Ze(zt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function Ir(e){return e&&"function"==typeof e.databases}function jr(e){return Xe(function(){return R.letThrough=!0,e()})}function Kr(e){return!("from"in e)}var ye=function(e,t){if(!this){var r=new ye;return e&&"d"in e&&Q(r,e),r}Q(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Dt(e,t,r){var n=te(t,r);if(!isNaN(n)){if(0<n)throw RangeError();if(Kr(e))return Q(e,{from:t,to:r,d:1});var s=e.l;if(n=e.r,te(r,e.from)<0)return s?Dt(s,t,r):e.l={from:t,to:r,d:1,l:null,r:null},mn(e);if(0<te(t,e.to))return n?Dt(n,t,r):e.r={from:t,to:r,d:1,l:null,r:null},mn(e);te(t,e.from)<0&&(e.from=t,e.l=null,e.d=n?n.d+1:1),0<te(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,s&&!e.l&&It(e,s),n&&r&&It(e,n)}}function It(e,t){Kr(t)||function r(n,p){var o=p.from,c=p.to,u=p.l;p=p.r,Dt(n,o,c),u&&r(n,u),p&&r(n,p)}(e,t)}function ir(e,t){var r=Rr(t),n=r.next();if(n.done)return!1;for(var s=n.value,o=Rr(e),c=o.next(s.from),u=c.value;!n.done&&!c.done;){if(te(u.from,s.to)<=0&&0<=te(u.to,s.from))return!0;te(s.from,u.from)<0?s=(n=r.next(u.from)).value:u=(c=o.next(s.from)).value}return!1}function Rr(e){var t=Kr(e)?null:{s:0,n:e};return{next:function(r){for(var n=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&te(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||te(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mn(e){var t,r,n=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(r=e.l)||void 0===r?void 0:r.d)||0),s=1<n?"r":n<-1?"l":"";s&&(t="r"==s?"l":"r",r=j({},e),e.from=(n=e[s]).from,e.to=n.to,e[s]=n[s],r[s]=n[t],(e[t]=r).d=vn(r)),e.d=vn(e)}function vn(r){var t=r.r;return r=r.l,(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function sr(e,t){return V(t).forEach(function(r){e[r]?It(e[r],t[r]):e[r]=function n(s){var o,c,u={};for(o in s)le(s,o)&&(u[o]=!(c=s[o])||"object"!=typeof c||E.has(c.constructor)?c:n(c));return u}(t[r])}),e}function Fr(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&ir(t[r],e[r])})}je(ye.prototype,((Ie={add:function(e){return It(this,e),this},addKey:function(e){return Dt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return Dt(t,r,r)}),this}})[he]=function(){return Rr(this)},Ie));var ft={},Br={},$r=!1;function ar(e){sr(Br,e),$r||($r=!0,setTimeout(function(){$r=!1,qr(Br,!(Br={}))},0))}function qr(e,t){void 0===t&&(t=!1);var r=new Set;if(e.all)for(var n=0,s=Object.values(ft);n<s.length;n++)gn(c=s[n],e,r,t);else for(var o in e){var c,u=/^idb\:\/\/(.*)\/(.*)\//.exec(o);u&&(o=u[1],u=u[2],(c=ft["idb://".concat(o,"/").concat(u)])&&gn(c,e,r,t))}r.forEach(function(p){return p()})}function gn(e,t,r,n){for(var s=[],o=0,c=Object.entries(e.queries.query);o<c.length;o++){for(var u=c[o],p=u[0],f=[],g=0,l=u[1];g<l.length;g++){var y=l[g];Fr(t,y.obsSet)?y.subscribers.forEach(function(m){return r.add(m)}):n&&f.push(y)}n&&s.push([p,f])}if(n)for(var d=0,v=s;d<v.length;d++){var _=v[d];e.queries.query[p=_[0]]=f=_[1]}}function Hn(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ce(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var n=t.openCanceller,s=Math.round(10*e.verno),o=!1;function c(){if(t.openCanceller!==n)throw new K.DatabaseClosed("db.open() was cancelled")}var p,f=t.dbReadyResolve,g=null,l=!1;return I.race([n,(typeof navigator>"u"?I.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(y){function d(){return indexedDB.databases().finally(y)}p=setInterval(d,100),d()}).finally(function(){return clearInterval(p)}):Promise.resolve()).then(function u(){return new I(function(y,d){if(c(),!r)throw new K.MissingAPI;var v=e.name,_=t.autoSchema||!s?r.open(v):r.open(v,s);if(!_)throw new K.MissingAPI;_.onerror=Be(d),_.onblocked=se(e._fireOnBlocked),_.onupgradeneeded=se(function(m){var b;g=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=Ot,g.abort(),_.result.close(),(b=r.deleteDatabase(v)).onsuccess=b.onerror=se(function(){d(new K.NoSuchDatabase("Database ".concat(v," doesnt exist")))})):(g.onerror=Be(d),m=m.oldVersion>Math.pow(2,62)?0:m.oldVersion,l=m<1,e.idbdb=_.result,o&&function $n(e,t){dn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=tr(0,e.idbdb,t);rr(e,e._dbSchema,t);for(var n=0,s=Ar(r,e._dbSchema).change;n<s.length;n++){var o=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var u=t.objectStore(c.name);c.add.forEach(function(p){De&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(p.src)),er(u,p)})}(s[n]);if("object"==typeof o)return o.value}}(e,g),function Bn(e,t,r,n){var s=e._dbSchema;r.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=Pr("$meta",pn("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,s);o.create(r),o._completion.catch(n);var c=o._reject.bind(o),u=R.transless||R;Xe(function(){return R.trans=o,R.transless=u,0!==t?(Vt(e,r),f=t,((p=o).storeNames.includes("$meta")?p.table("$meta").get("version").then(function(g){return g??f}):I.resolve(f)).then(function(g){return y=g,d=o,_=[],g=(l=e)._versions,m=l._dbSchema=tr(0,l.idbdb,v=r),0!==(g=g.filter(function(b){return b._cfg.version>=y})).length?(g.forEach(function(b){_.push(function(){var S=m,x=b._cfg.dbschema;rr(l,S,v),rr(l,x,v),m=l._dbSchema=x;var C=Ar(S,x);C.add.forEach(function(N){Nr(v,N[0],N[1].primKey,N[1].indexes)}),C.change.forEach(function(N){if(N.recreate)throw new K.Upgrade("Not yet support for changing primary key");var D=v.objectStore(N.name);N.add.forEach(function($){return er(D,$)}),N.change.forEach(function($){D.deleteIndex($.name),er(D,$)}),N.del.forEach(function($){return D.deleteIndex($)})});var M=b._cfg.contentUpgrade;if(M&&b._cfg.version>y){Vt(l,v),d._memoizedTables={};var A=a(x);C.del.forEach(function(N){A[N]=S[N]}),Tr(l,[l.Transaction.prototype]),Jt(l,[l.Transaction.prototype],V(A),A),d.schema=A;var P,T=Ke(M);return T&&yt(),C=I.follow(function(){var N;(P=M(d))&&T&&(N=Ge.bind(null,null),P.then(N,N))}),P&&"function"==typeof P.then?I.resolve(P):C.then(function(){return P})}}),_.push(function(S){var x,C;x=b._cfg.dbschema,[].slice.call((C=S).db.objectStoreNames).forEach(function(A){return null==x[A]&&C.db.deleteObjectStore(A)}),Tr(l,[l.Transaction.prototype]),Jt(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),d.schema=l._dbSchema}),_.push(function(S){l.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(l.idbdb.version/10)===b._cfg.version?(l.idbdb.deleteObjectStore("$meta"),delete l._dbSchema.$meta,l._storeNames=l._storeNames.filter(function(x){return"$meta"!==x})):S.objectStore("$meta").put(b._cfg.version,"version"))})}),function b(){return _.length?I.resolve(_.shift()(d.idbtrans)).then(b):I.resolve()}().then(function(){dn(m,v)})):I.resolve();var l,y,d,v,_,m}).catch(c)):(V(s).forEach(function(g){Nr(r,g,s[g].primKey,s[g].indexes)}),Vt(e,r),void I.follow(function(){return e.on.populate.fire(o)}).catch(c));var p,f})}(e,m/10,g,d))},d),_.onsuccess=se(function(){g=null;var m,b,S,x,C,M=e.idbdb=_.result,A=Ae(M.objectStoreNames);if(0<A.length)try{var P=M.transaction(1===(x=A).length?x[0]:x,"readonly");if(t.autoSchema)S=P,(m=e).verno=(b=M).version/10,S=m._dbSchema=tr(0,b,S),m._storeNames=Ae(b.objectStoreNames,0),Jt(m,[m._allTables],V(S),S);else if(rr(e,e._dbSchema,P),((C=Ar(tr(0,(C=e).idbdb,P),C._dbSchema)).add.length||C.change.some(function(T){return T.add.length||T.change.length}))&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),M.close(),s=M.version+1,o=!0,y(u());Vt(e,P)}catch{}_t.push(e),M.onversionchange=se(function(T){t.vcFired=!0,e.on("versionchange").fire(T)}),M.onclose=se(function(T){e.on("close").fire(T)}),l&&(P=v,M=(C=e._deps).indexedDB,C=C.IDBKeyRange,Ir(M)||P===zt||Dr(M,C).put({name:P}).catch(H)),y()},d)}).catch(function(y){switch(y?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),u();break;case"VersionError":if(0<s)return s=0,u()}return I.reject(y)})})]).then(function(){return c(),t.onReadyBeingFired=[],I.resolve(jr(function(){return e.on.ready.fire(e.vip)})).then(function y(){if(0<t.onReadyBeingFired.length){var d=t.onReadyBeingFired.reduce(nt,H);return t.onReadyBeingFired=[],I.resolve(jr(function(){return d(e.vip)})).then(y)}})}).finally(function(){t.openCanceller===n&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(y){t.dbOpenError=y;try{g&&g.abort()}catch{}return n===t.openCanceller&&e._close(),ce(y)}).finally(function(){t.openComplete=!0,f()}).then(function(){var y;return l&&(y={},e.tables.forEach(function(d){d.schema.indexes.forEach(function(v){v.name&&(y["idb://".concat(e.name,"/").concat(d.name,"/").concat(v.name)]=new ye(-1/0,[[[]]]))}),y["idb://".concat(e.name,"/").concat(d.name,"/")]=y["idb://".concat(e.name,"/").concat(d.name,"/:dels")]=new ye(-1/0,[[[]]])}),Ve(Tt).fire(y),qr(y,!0)),e})}function Hr(e){function t(o){return e.next(o)}var r=s(t),n=s(function(o){return e.throw(o)});function s(o){return function(p){var u=o(p);return p=u.value,u.done?p:p&&"function"==typeof p.then?p.then(r,n):re(p)?Promise.all(p).then(r,n):r(p)}}return s(t)()}function or(e,t,r){for(var n=re(e)?e.slice():[e],s=0;s<r;++s)n.push(t);return n}var Ln={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return j(j({},e),{table:function(t){var r=e.table(t),n=r.schema,s={},o=[];function c(l,y,d){var v=Nt(l),_=s[v]=s[v]||[],m=null==l?0:"string"==typeof l?1:l.length,b=0<y;return b=j(j({},d),{name:b?"".concat(v,"(virtual-from:").concat(d.name,")"):d.name,lowLevelIndex:d,isVirtual:b,keyTail:y,keyLength:m,extractKey:Or(l),unique:!b&&d.unique}),_.push(b),b.isPrimaryKey||o.push(b),1<m&&c(2===m?l[0]:l.slice(0,m-1),y+1,d),_.sort(function(S,x){return S.keyTail-x.keyTail}),b}t=c(n.primaryKey.keyPath,0,n.primaryKey),s[":id"]=[t];for(var u=0,p=n.indexes;u<p.length;u++){var f=p[u];c(f.keyPath,0,f)}function g(l){var y,d=l.query.index;return d.isVirtual?j(j({},l),{query:{index:d.lowLevelIndex,range:(y=l.query.range,d=d.keyTail,{type:1===y.type?2:y.type,lower:or(y.lower,y.lowerOpen?e.MAX_KEY:e.MIN_KEY,d),lowerOpen:!0,upper:or(y.upper,y.upperOpen?e.MIN_KEY:e.MAX_KEY,d),upperOpen:!0})}}):l}return j(j({},r),{schema:j(j({},n),{primaryKey:t,indexes:o,getIndexByKeyPath:function(l){return(l=s[Nt(l)])&&l[0]}}),count:function(l){return r.count(g(l))},query:function(l){return r.query(g(l))},openCursor:function(l){var y=l.query.index,d=y.keyTail,_=y.keyLength;return y.isVirtual?r.openCursor(g(l)).then(function(b){return b&&function m(b){return Object.create(b,{continue:{value:function(S){null!=S?b.continue(or(S,l.reverse?e.MAX_KEY:e.MIN_KEY,d)):l.unique?b.continue(b.key.slice(0,_).concat(l.reverse?e.MIN_KEY:e.MAX_KEY,d)):b.continue()}},continuePrimaryKey:{value:function(S,x){b.continuePrimaryKey(or(S,e.MAX_KEY,d),x)}},primaryKey:{get:function(){return b.primaryKey}},key:{get:function(){var S=b.key;return 1===_?S[0]:S.slice(0,_)}},value:{get:function(){return b.value}}})}(b)}):r.openCursor(l)}})}})}};function Lr(e,t,r,n){return r=r||{},n=n||"",V(e).forEach(function(s){var o,c,u;le(t,s)?(c=t[s],"object"==typeof(o=e[s])&&"object"==typeof c&&o&&c?(u=q(o))!==q(c)?r[n+s]=t[s]:"Object"===u?Lr(o,c,r,n+s+"."):o!==c&&(r[n+s]=t[s]):o!==c&&(r[n+s]=t[s])):r[n+s]=void 0}),V(t).forEach(function(s){le(e,s)||(r[n+s]=t[s])}),r}function Wr(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Wn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return j(j({},e),{table:function(t){var r=e.table(t),n=r.schema.primaryKey;return j(j({},r),{mutate:function(s){var o=R.trans,c=o.table(t).hook,u=c.deleting,p=c.creating,f=c.updating;switch(s.type){case"add":if(p.fire===H)break;return o._promise("readwrite",function(){return g(s)},!0);case"put":if(p.fire===H&&f.fire===H)break;return o._promise("readwrite",function(){return g(s)},!0);case"delete":if(u.fire===H)break;return o._promise("readwrite",function(){return g(s)},!0);case"deleteRange":if(u.fire===H)break;return o._promise("readwrite",function(){return function l(y,d,v){return r.query({trans:y,values:!1,query:{index:n,range:d},limit:v}).then(function(_){var m=_.result;return g({type:"delete",keys:m,trans:y}).then(function(b){return 0<b.numFailures?Promise.reject(b.failures[0]):m.length<v?{failures:[],numFailures:0,lastResult:void 0}:l(y,j(j({},d),{lower:m[m.length-1],lowerOpen:!0}),v)})})}(s.trans,s.range,1e4)},!0)}return r.mutate(s);function g(l){var y,d,v,_=R.trans,m=l.keys||Wr(n,l);if(!m)throw new Error("Keys missing");return"delete"!==(l="add"===l.type||"put"===l.type?j(j({},l),{keys:m}):j({},l)).type&&(l.values=we([],l.values,!0)),l.keys&&(l.keys=we([],l.keys,!0)),y=r,v=m,("add"===(d=l).type?Promise.resolve([]):y.getMany({trans:d.trans,keys:v,cache:"immutable"})).then(function(b){var S=m.map(function(x,C){var M,A,P,T=b[C],N={onerror:null,onsuccess:null};return"delete"===l.type?u.fire.call(N,x,T,_):"add"===l.type||void 0===T?(M=p.fire.call(N,x,l.values[C],_),null==x&&null!=M&&(l.keys[C]=x=M,n.outbound||i(l.values[C],n.keyPath,x))):(M=Lr(T,l.values[C]),(A=f.fire.call(N,M,x,T,_))&&(P=l.values[C],Object.keys(A).forEach(function(D){le(P,D)?P[D]=A[D]:i(P,D,A[D])}))),N});return r.mutate(l).then(function(x){for(var C=x.failures,M=x.results,A=x.numFailures,P=(x=x.lastResult,0);P<m.length;++P){var T=(M||m)[P],N=S[P];null==T?N.onerror&&N.onerror(C[P]):N.onsuccess&&N.onsuccess("put"===l.type&&b[P]?l.values[P]:T)}return{failures:C,results:M,numFailures:A,lastResult:x}}).catch(function(x){return S.forEach(function(C){return C.onerror&&C.onerror(x)}),Promise.reject(x)})})}}})}})}};function yn(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var n=[],s=0,o=0;s<t.keys.length&&o<e.length;++s)0===te(t.keys[s],e[o])&&(n.push(r?w(t.values[s]):t.values[s]),++o);return n.length===e.length?n:null}catch{return null}}var Zn={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return j(j({},r),{getMany:function(n){if(!n.cache)return r.getMany(n);var s=yn(n.keys,n.trans._cache,"clone"===n.cache);return s?I.resolve(s):r.getMany(n).then(function(o){return n.trans._cache={keys:n.keys,values:"clone"===n.cache?w(o):o},o})},mutate:function(n){return"add"!==n.type&&(n.trans._cache=null),r.mutate(n)}})}}}};function _n(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function bn(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Un={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new ye(e.MIN_KEY,e.MAX_KEY);return j(j({},e),{transaction:function(n,s,o){if(R.subscr&&"readonly"!==s)throw new K.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(R.querier));return e.transaction(n,s,o)},table:function(n){var s=e.table(n),o=s.schema,c=o.primaryKey,l=o.indexes,u=c.extractKey,p=c.outbound,f=c.autoIncrement&&l.filter(function(d){return d.compound&&d.keyPath.includes(c.keyPath)}),g=j(j({},s),{mutate:function(d){function v(D){return D="idb://".concat(t,"/").concat(n,"/").concat(D),x[D]||(x[D]=new ye)}var _,m,b,S=d.trans,x=d.mutatedParts||(d.mutatedParts={}),C=v(""),M=v(":dels"),A=d.type,P=(N="deleteRange"===d.type?[d.range]:"delete"===d.type?[d.keys]:d.values.length<50?[Wr(c,d).filter(function(D){return D}),d.values]:[])[0],T=N[1],N=d.trans._cache;return re(P)?(C.addKeys(P),(N="delete"===A||P.length===T.length?yn(P,N):null)||M.addKeys(P),(N||T)&&(_=v,m=N,b=T,o.indexes.forEach(function(D){var $=_(D.name||"");function Z(U){return null!=U?D.extractKey(U):null}function X(U){return D.multiEntry&&re(U)?U.forEach(function(Fe){return $.addKey(Fe)}):$.addKey(U)}(m||b).forEach(function(U,_e){var z=m&&Z(m[_e]);0!==te(z,_e=b&&Z(b[_e]))&&(null!=z&&X(z),null!=_e&&X(_e))})}))):P?(M.add(T={from:P.lower,to:P.upper}),C.add(T)):(C.add(r),M.add(r),o.indexes.forEach(function(D){return v(D.name).add(r)})),s.mutate(d).then(function(D){return!P||"add"!==d.type&&"put"!==d.type||(C.addKeys(D.results),f&&f.forEach(function($){var Z=d.values.map(function(U){return $.extractKey(U)}),X=$.keyPath.findIndex(function(U){return U===c.keyPath});D.results.forEach(function(U){return Z[X]=U}),v($.name).addKeys(Z)})),S.mutatedParts=sr(S.mutatedParts||{},x),D})}}),y={get:function(d){return[c,new ye(d.key)]},getMany:function(d){return[c,(new ye).addKeys(d.keys)]},count:l=function(v){var _;return[v=(_=v.query).index,new ye(null!==(v=(_=_.range).lower)&&void 0!==v?v:e.MIN_KEY,null!==(_=_.upper)&&void 0!==_?_:e.MAX_KEY)]},query:l,openCursor:l};return V(y).forEach(function(d){g[d]=function(v){var m=!!(_=R.subscr),b=_n(R,s)&&bn(d,v)?v.obsSet={}:_;if(m){var S=function(T){return T="idb://".concat(t,"/").concat(n,"/").concat(T),b[T]||(b[T]=new ye)},x=S(""),C=S(":dels"),_=(m=(_=y[d](v))[0],_[1]);if(("query"===d&&m.isPrimaryKey&&!v.values?C:S(m.name||"")).add(_),!m.isPrimaryKey){if("count"!==d){var M="query"===d&&p&&v.values&&s.query(j(j({},v),{values:!1}));return s[d].apply(this,arguments).then(function(T){if("query"===d){if(p&&v.values)return M.then(function(Z){return x.addKeys(Z=Z.result),T});var N=v.values?T.result.map(u):T.result;(v.values?x:C).addKeys(N)}else if("openCursor"===d){var D=T,$=v.values;return D&&Object.create(D,{key:{get:function(){return C.addKey(D.primaryKey),D.key}},primaryKey:{get:function(){var Z=D.primaryKey;return C.addKey(Z),Z}},value:{get:function(){return $&&x.addKey(D.primaryKey),D.value}}})}return T})}C.add(r)}}return s[d].apply(this,arguments)}}),g}})}};function kn(e,t,r){return 0===r.numFailures?t:"deleteRange"===t.type||r.numFailures===(t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1)?null:(t=j({},t),re(t.keys)&&(t.keys=t.keys.filter(function(s,o){return!(o in r.failures)})),"values"in t&&re(t.values)&&(t.values=t.values.filter(function(s,o){return!(o in r.failures)})),t)}function Zr(e,t){return r=e,(void 0===(n=t).lower||(n.lowerOpen?0<te(r,n.lower):0<=te(r,n.lower)))&&(void 0===t.upper||(t.upperOpen?te(e,t.upper)<0:te(e,t.upper)<=0));var r,n}function Sn(e,t,y,n,s,o){if(!y||0===y.length)return e;var c=t.query.index,u=c.multiEntry,p=t.query.range,f=n.schema.primaryKey.extractKey,g=c.extractKey,l=(c.lowLevelIndex||c).extractKey;return(y=y.reduce(function(d,v){var _=d,m="add"===v.type||"put"===v.type?v.values.filter(function(C){return C=g(C),u&&re(C)?C.some(function(M){return Zr(M,p)}):Zr(C,p)}).map(function(C){return C=w(C),o&&Object.freeze(C),C}):[];switch(v.type){case"add":_=d.concat(t.values?m:m.map(function(M){return f(M)}));break;case"put":var b=(new ye).addKeys(v.values.map(function(M){return f(M)}));_=d.filter(function(M){return M=t.values?f(M):M,!ir(new ye(M),b)}).concat(t.values?m:m.map(function(M){return f(M)}));break;case"delete":var S=(new ye).addKeys(v.keys);_=d.filter(function(M){return M=t.values?f(M):M,!ir(new ye(M),S)});break;case"deleteRange":var x=v.range;_=d.filter(function(M){return!Zr(f(M),x)})}return _},e))===e?e:(y.sort(function(d,v){return te(l(d),l(v))||te(f(d),f(v))}),t.limit&&t.limit<1/0&&(y.length>t.limit?y.length=t.limit:e.length===t.limit&&y.length<t.limit&&(s.dirty=!0)),o?Object.freeze(y):y)}function wn(e,t){return 0===te(e.lower,t.lower)&&0===te(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}var Gn={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return j(j({},e),{transaction:function(r,n,s){var o,c,u=e.transaction(r,n,s);return"readwrite"===n&&(c=(o=new AbortController).signal,u.addEventListener("abort",(s=function(p){return function(){if(o.abort(),"readwrite"===n){for(var f=new Set,g=0,l=r;g<l.length;g++){var y=l[g],d=ft["idb://".concat(t,"/").concat(y)];if(d){var v=e.table(y),_=d.optimisticOps.filter(function($){return $.trans===u});if(u._explicit&&p&&u.mutatedParts)for(var m=0,b=Object.values(d.queries.query);m<b.length;m++)for(var S=0,x=(A=b[m]).slice();S<x.length;S++)Fr((P=x[S]).obsSet,u.mutatedParts)&&(W(A,P),P.subscribers.forEach(function($){return f.add($)}));else if(0<_.length){d.optimisticOps=d.optimisticOps.filter(function($){return $.trans!==u});for(var C=0,M=Object.values(d.queries.query);C<M.length;C++)for(var A,P,T,N=0,D=(A=M[C]).slice();N<D.length;N++)null!=(P=D[N]).res&&u.mutatedParts&&(p&&!P.dirty?(T=Object.isFrozen(P.res),T=Sn(P.res,P.req,_,v,P,T),P.dirty?(W(A,P),P.subscribers.forEach(function($){return f.add($)})):T!==P.res&&(P.res=T,P.promise=I.resolve({result:T}))):(P.dirty&&W(A,P),P.subscribers.forEach(function($){return f.add($)})))}}}f.forEach(function($){return $()})}}})(!1),{signal:c}),u.addEventListener("error",s(!1),{signal:c}),u.addEventListener("complete",s(!0),{signal:c})),u},table:function(r){var n=e.table(r),s=n.schema.primaryKey;return j(j({},n),{mutate:function(o){var c=R.trans;if(s.outbound||"disabled"===c.db._options.cache||c.explicit)return n.mutate(o);var u=ft["idb://".concat(t,"/").concat(r)];return u?(c=n.mutate(o),"add"!==o.type&&"put"!==o.type||!(50<=o.values.length||Wr(s,o).some(function(p){return null==p}))?(u.optimisticOps.push(o),o.mutatedParts&&ar(o.mutatedParts),c.then(function(p){0<p.numFailures&&(W(u.optimisticOps,o),(p=kn(0,o,p))&&u.optimisticOps.push(p),o.mutatedParts&&ar(o.mutatedParts))}),c.catch(function(){W(u.optimisticOps,o),o.mutatedParts&&ar(o.mutatedParts)})):c.then(function(p){var f=kn(0,j(j({},o),{values:o.values.map(function(d,l){var y;return i(d=null!==(y=s.keyPath)&&void 0!==y&&y.includes(".")?w(d):j({},d),s.keyPath,p.results[l]),d})}),p);u.optimisticOps.push(f),queueMicrotask(function(){return o.mutatedParts&&ar(o.mutatedParts)})}),c):n.mutate(o)},query:function(o){if(!_n(R,n)||!bn("query",o))return n.query(o);var c="immutable"===(null===(f=R.trans)||void 0===f?void 0:f.db._options.cache),u=(l=R).requery,p=l.signal,f=function(v,_,m,b){var S=ft["idb://".concat(v,"/").concat(_)];if(!S)return[];if(!(_=S.queries[m]))return[null,!1,S,null];var x=_[(b.query?b.query.index.name:null)||""];if(!x)return[null,!1,S,null];switch(m){case"query":var C=x.find(function(M){return M.req.limit===b.limit&&M.req.values===b.values&&wn(M.req.query.range,b.query.range)});return C?[C,!0,S,x]:[x.find(function(M){return("limit"in M.req?M.req.limit:1/0)>=b.limit&&(!b.values||M.req.values)&&function zn(e,t){return function(r,n,s,o){if(void 0===r)return void 0!==n?-1:0;if(void 0===n)return 1;if(0===(n=te(r,n))){if(s&&o)return 0;if(s)return 1;if(o)return-1}return n}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,n,s,o){if(void 0===r)return void 0!==n?1:0;if(void 0===n)return-1;if(0===(n=te(r,n))){if(s&&o)return 0;if(s)return-1;if(o)return 1}return n}(e.upper,t.upper,e.upperOpen,t.upperOpen)}(M.req.query.range,b.query.range)}),!1,S,x];case"count":return[C=x.find(function(M){return wn(M.req.query.range,b.query.range)}),!!C,S,x]}}(t,r,"query",o),g=f[0],l=f[1],y=f[2],d=f[3];return g&&l?g.obsSet=o.obsSet:(l=n.query(o).then(function(v){var _=v.result;if(g&&(g.res=_),c){for(var m=0,b=_.length;m<b;++m)Object.freeze(_[m]);Object.freeze(_)}else v.result=w(_);return v}).catch(function(v){return d&&g&&W(d,g),Promise.reject(v)}),g={obsSet:o.obsSet,promise:l,subscribers:new Set,type:"query",req:o,dirty:!1},d?d.push(g):(d=[g],(y=y||(ft["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[o.query.index.name||""]=d)),function Xn(e,t,r,n){e.subscribers.add(r),n.addEventListener("abort",function(){var s,o;e.subscribers.delete(r),0===e.subscribers.size&&(s=e,o=t,setTimeout(function(){0===s.subscribers.size&&W(o,s)},3e3))})}(g,d,u,p),g.promise.then(function(v){return{result:Sn(v.result,o,y?.optimisticOps,n,g,c)}})}})}})}};function cr(e,t){return new Proxy(e,{get:function(r,n,s){return"db"===n?t:Reflect.get(r,n,s)}})}var Ze=(ue.prototype.version=function(e){if(isNaN(e)||e<.1)throw new K.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(n){return n._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(Fn),r.stores({}),this._state.autoSchema=!1,r)},ue.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||R.letThrough||this._vip)?e():new I(function(r,n){if(t._state.openComplete)return n(new K.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new K.DatabaseClosed);t.open().catch(H)}t._state.dbReadyPromise.then(r,n)}).then(e)},ue.prototype.use=function(e){var t=e.stack,r=e.create,n=e.level,s=e.name;return s&&this.unuse({stack:t,name:s}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:r,level:n??10,name:s}),e.sort(function(o,c){return o.level-c.level}),this},ue.prototype.unuse=function(e){var t=e.stack,r=e.name,n=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(s){return n?s.create!==n:!!r&&s.name!==r})),this},ue.prototype.open=function(){var e=this;return ut(ze,function(){return Hn(e)})},ue.prototype._close=function(){var e=this._state,t=_t.indexOf(this);if(0<=t&&_t.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new I(function(r){e.dbReadyResolve=r}),e.openCanceller=new I(function(r,n){e.cancelOpen=n}))},ue.prototype.close=function(r){var t=(void 0===r?{disableAutoOpen:!0}:r).disableAutoOpen;r=this._state,t?(r.isBeingOpened&&r.cancelOpen(new K.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new K.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},ue.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var r=0<arguments.length&&"object"!=typeof arguments[0],n=this._state;return new I(function(s,o){function c(){t.close(e);var u=t._deps.indexedDB.deleteDatabase(t.name);u.onsuccess=se(function(){var p,f,g;f=t.name,g=(p=t._deps).indexedDB,p=p.IDBKeyRange,Ir(g)||f===zt||Dr(g,p).delete(f).catch(H),s()}),u.onerror=Be(o),u.onblocked=t._fireOnBlocked}if(r)throw new K.InvalidArgument("Invalid closeOptions argument to db.delete()");n.isBeingOpened?n.dbReadyPromise.then(c):c()})},ue.prototype.backendDB=function(){return this.idbdb},ue.prototype.isOpen=function(){return null!==this.idbdb},ue.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},ue.prototype.hasFailed=function(){return null!==this._state.dbOpenError},ue.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ue.prototype,"tables",{get:function(){var e=this;return V(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ue.prototype.transaction=function(){var e=function(t,r,n){var s=arguments.length;if(s<2)throw new K.InvalidArgument("Too few arguments");for(var o=new Array(s-1);--s;)o[s-1]=arguments[s];return n=o.pop(),[t,k(o),n]}.apply(this,arguments);return this._transaction.apply(this,e)},ue.prototype._transaction=function(e,t,r){var n=this,s=R.trans;s&&s.db===this&&-1===e.indexOf("!")||(s=null);var o,c,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(c=t.map(function(f){if("string"!=typeof(f=f instanceof n.Table?f.name:f))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),"r"==e||e===br)o=br;else{if("rw"!=e&&e!=kr)throw new K.InvalidArgument("Invalid transaction mode: "+e);o=kr}if(s){if(s.mode===br&&o===kr){if(!u)throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&c.forEach(function(f){if(s&&-1===s.storeNames.indexOf(f)){if(!u)throw new K.SubTransaction("Table "+f+" not included in parent transaction.");s=null}}),u&&s&&!s.active&&(s=null)}}catch(f){return s?s._promise(null,function(g,l){l(f)}):ce(f)}var p=function f(g,l,y,d,v){return I.resolve().then(function(){var _=R.transless||R,m=g._createTransaction(l,y,g._dbSchema,d);if(m.explicit=!0,_={trans:m,transless:_},d)m.idbtrans=d.idbtrans;else try{m.create(),m.idbtrans._explicit=!0,g._state.PR1398_maxLoop=3}catch(x){return x.name===ve.InvalidState&&g.isOpen()&&0<--g._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),g.close({disableAutoOpen:!1}),g.open().then(function(){return f(g,l,y,null,v)})):ce(x)}var b,S=Ke(v);return S&&yt(),_=I.follow(function(){var x;(b=v.call(m,m))&&(S?(x=Ge.bind(null,null),b.then(x,x)):"function"==typeof b.next&&"function"==typeof b.throw&&(b=Hr(b)))},_),(b&&"function"==typeof b.then?I.resolve(b).then(function(x){return m.active?x:ce(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return b})).then(function(x){return d&&m._resolve(),m._completion.then(function(){return x})}).catch(function(x){return m._reject(x),ce(x)})})}.bind(null,this,o,c,s,r);return s?s._promise(o,p,"lock"):R.trans?ut(R.transless,function(){return n._whenReady(p)}):this._whenReady(p)},ue.prototype.table=function(e){if(!le(this._allTables,e))throw new K.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ue);function ue(e,t){var r=this;this._middlewares={},this.verno=0;var n=ue.dependencies;this._options=t=j({addons:ue.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},n=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,o,c,u,p,f={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:H,dbReadyPromise:null,cancelOpen:H,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};f.dbReadyPromise=new I(function(l){f.dbReadyResolve=l}),f.openCanceller=new I(function(l,y){f.cancelOpen=y}),this._state=f,this.name=e,this.on=Et(this,"populate","blocked","versionchange","close",{ready:[nt,H]}),this.on.ready.subscribe=de(this.on.ready.subscribe,function(l){return function(y,d){ue.vip(function(){var v,_=r._state;_.openComplete?(_.dbOpenError||I.resolve().then(y),d&&l(y)):_.onReadyBeingFired?(_.onReadyBeingFired.push(y),d&&l(y)):(l(y),v=r,d||l(function m(){v.on.ready.unsubscribe(y),v.on.ready.unsubscribe(m)}))})}}),this.Collection=(s=this,Pt(An.prototype,function(b,m){this.db=s;var d=en,v=null;if(m)try{d=m()}catch(S){v=S}var _=b._ctx;this._ctx={table:m=_.table,index:_.index,isPrimKey:!_.index||m.schema.primKey.keyPath&&_.index===m.schema.primKey.name,range:d,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:v,or:_.or,valueMapper:(b=m.hook.reading.fire)!==ge?b:null}})),this.Table=(o=this,Pt(sn.prototype,function(l,y,d){this.db=o,this._tx=d,this.name=l,this.schema=y,this.hook=o._allTables[l]?o._allTables[l].hook:Et(null,{creating:[mt,H],reading:[hr,ge],updating:[xt,H],deleting:[rt,H]})})),this.Transaction=(c=this,Pt(In.prototype,function(l,y,d,v,_){var m=this;this.db=c,this.mode=l,this.storeNames=y,this.schema=d,this.chromeTransactionDurability=v,this.idbtrans=null,this.on=Et(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new I(function(b,S){m._resolve=b,m._reject=S}),this._completion.then(function(){m.active=!1,m.on.complete.fire()},function(b){var S=m.active;return m.active=!1,m.on.error.fire(b),m.parent?m.parent._reject(b):S&&m.idbtrans&&m.idbtrans.abort(),ce(b)})})),this.Version=(u=this,Pt(qn.prototype,function(l){this.db=u,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(p=this,Pt(ln.prototype,function(l,y,d){if(this.db=p,this._ctx={table:l,index:":id"===y?null:y,or:d},this._cmp=this._ascending=te,this._descending=function(v,_){return te(_,v)},this._max=function(v,_){return 0<te(v,_)?v:_},this._min=function(v,_){return te(v,_)<0?v:_},this._IDBKeyRange=p._deps.IDBKeyRange,!this._IDBKeyRange)throw new K.MissingAPI})),this.on("versionchange",function(l){0<l.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(l){!l.newVersion||l.newVersion<l.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(l.oldVersion/10))}),this._maxKey=At(t.IDBKeyRange),this._createTransaction=function(l,y,d,v){return new r.Transaction(l,y,d,r._options.chromeTransactionDurability,v)},this._fireOnBlocked=function(l){r.on("blocked").fire(l),_t.filter(function(y){return y.name===r.name&&y!==r&&!y._state.vcFired}).map(function(y){return y.on("versionchange").fire(l)})},this.use(Zn),this.use(Gn),this.use(Un),this.use(Ln),this.use(Wn);var g=new Proxy(this,{get:function(l,y,d){if("_vip"===y)return!0;if("table"===y)return function(_){return cr(r.table(_),g)};var v=Reflect.get(l,y,d);return v instanceof sn?cr(v,g):"tables"===y?v.map(function(_){return cr(_,g)}):"_createTransaction"===y?function(){return cr(v.apply(this,arguments),g)}:v}});this.vip=g,n.forEach(function(l){return l(r)})}Ie=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";var ur,Qn=(Ur.prototype.subscribe=function(e,t,r){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:r})},Ur.prototype[Ie]=function(){return this},Ur);function Ur(e){this._subscribe=e}try{ur={indexedDB:F.indexedDB||F.mozIndexedDB||F.webkitIndexedDB||F.msIndexedDB,IDBKeyRange:F.IDBKeyRange||F.webkitIDBKeyRange}}catch{ur={indexedDB:null,IDBKeyRange:null}}function xn(e){var t,r=!1,n=new Qn(function(s){var c,o=Ke(e),u=!1,p={},f={},g={get closed(){return u},unsubscribe:function(){u||(u=!0,c&&c.abort(),l&&Ve.storagemutated.unsubscribe(d))}};s.start&&s.start(g);var l=!1,y=function(){return _r(v)},d=function(_){sr(p,_),Fr(f,p)&&y()},v=function(){var _,m,b;!u&&ur.indexedDB&&(p={},_={},c&&c.abort(),c=new AbortController,b=function(S){var x=vt();try{o&&yt();var C=Xe(e,S);return C=o?C.finally(Ge):C}finally{x&&gt()}}(m={subscr:_,signal:c.signal,requery:y,querier:e,trans:null}),Promise.resolve(b).then(function(S){r=!0,t=S,u||m.signal.aborted||(p={},function(x){for(var C in x)if(le(x,C))return;return 1}(f=_)||l||(Ve(Tt,d),l=!0),_r(function(){return!u&&s.next&&s.next(S)}))},function(S){r=!1,["DatabaseClosedError","AbortError"].includes(S?.name)||u||_r(function(){u||s.error&&s.error(S)})}))};return setTimeout(y,0),g});return n.hasValue=function(){return r},n.getValue=function(){return t},n}var dt=Ze;function zr(e){var t=Je;try{Je=!0,Ve.storagemutated.fire(e),qr(e,!0)}finally{Je=t}}je(dt,j(j({},Re),{delete:function(e){return new dt(e,{addons:[]}).delete()},exists:function(e){return new dt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return r=(t=dt.dependencies).indexedDB,t=t.IDBKeyRange,(Ir(r)?Promise.resolve(r.databases()).then(function(n){return n.map(function(s){return s.name}).filter(function(s){return s!==zt})}):Dr(r,t).toCollection().primaryKeys()).then(e)}catch{return ce(new K.MissingAPI)}var t,r},defineClass:function(){return function(e){Q(this,e)}},ignoreTransaction:function(e){return R.trans?ut(R.transless,e):e()},vip:jr,async:function(e){return function(){try{var t=Hr(e.apply(this,arguments));return t&&"function"==typeof t.then?t:I.resolve(t)}catch(r){return ce(r)}}},spawn:function(e,t,r){try{var n=Hr(e.apply(r,t||[]));return n&&"function"==typeof n.then?n:I.resolve(n)}catch(s){return ce(s)}},currentTransaction:{get:function(){return R.trans||null}},waitFor:function(e,t){return t=I.resolve("function"==typeof e?dt.ignoreTransaction(e):e).timeout(t||6e4),R.trans?R.trans.waitFor(t):t},Promise:I,debug:{get:function(){return De},set:function(e){Rt(e)}},derive:xe,extend:Q,props:je,override:de,Events:Et,on:Ve,liveQuery:xn,extendObservabilitySet:sr,getByKeyPath:Ce,setByKeyPath:i,delByKeyPath:function(e,t){"string"==typeof t?i(e,t,void 0):"length"in t&&[].map.call(t,function(r){i(e,r,void 0)})},shallowClone:a,deepClone:w,getObjectDiff:Lr,cmp:te,asap:Y,minKey:-1/0,addons:[],connections:_t,errnames:ve,dependencies:ur,cache:ft,semVer:"4.0.4",version:"4.0.4".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),dt.maxKey=At(dt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ve(Tt,function(e){Je||(e=new CustomEvent(Mr,{detail:e}),Je=!0,dispatchEvent(e),Je=!1)}),addEventListener(Mr,function(e){e=e.detail,Je||zr(e)}));var St,Je=!1,Cn=function(){};return typeof BroadcastChannel<"u"&&((Cn=function(){(St=new BroadcastChannel(Mr)).onmessage=function(e){return e.data&&zr(e.data)}})(),"function"==typeof St.unref&&St.unref(),Ve(Tt,function(e){Je||St.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Ze.disableBfCache&&e.persisted){De&&console.debug("Dexie: handling persisted pagehide"),St?.close();for(var t=0,r=_t;t<r.length;t++)r[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Ze.disableBfCache&&e.persisted&&(De&&console.debug("Dexie: handling persisted pageshow"),Cn(),zr({all:new ye(-1/0,[[]])}))})),I.rejectionMapper=function(e,t){return!e||e instanceof Ne||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Ee[e.name]?e:(t=new Ee[e.name](t||e.message,e),"stack"in e&&Me(t,"stack",{get:function(){return this.inner.stack}}),t)},Rt(De),j(Ze,Object.freeze({__proto__:null,Dexie:Ze,liveQuery:xn,Entity:tn,cmp:te,PropModSymbol:We,PropModification:xr,replacePrefix:function(e,t){return new xr({replacePrefix:[e,t]})},default:Ze,RangeSet:ye,mergeRanges:It,rangesOverlap:ir}),{default:Ze}),Ze}()},4096:(wt,Oe,j)=>{"use strict";j.d(Oe,{Ay:()=>J,Dd:()=>re});var we=j(5505);const F=Symbol.for("Dexie"),V=globalThis[F]||(globalThis[F]=we);if(we.semVer!==V.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${we.semVer} and ${V.semVer}`);const{liveQuery:re}=V,J=V},9830:(wt,Oe,j)=>{"use strict";j.d(Oe,{Dw:()=>jt,Zr:()=>de});var we=j(4523),F=j(4438),V=j(177),re=j(4341);const Q=new F.nKC("ngx-mask config"),Te=new F.nKC("new ngx-mask config"),et=new F.nKC("initial ngx-mask config"),le={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showTemplate:!1,showMaskTyped:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:void 0,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:Y=>Y,outputTransformFn:Y=>Y,maskFilled:new F.bkB,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},je=["Hh:m0:s0","Hh:m0","m0:s0"],tt=["percent","Hh","s0","m0","separator","d0/M0/0000","d0/M0","d0","M0"];let Me=(()=>{class Y{constructor(){this._config=(0,F.WQX)(Q),this.dropSpecialCharacters=this._config.dropSpecialCharacters,this.hiddenInput=this._config.hiddenInput,this.clearIfNotMatch=this._config.clearIfNotMatch,this.specialCharacters=this._config.specialCharacters,this.patterns=this._config.patterns,this.prefix=this._config.prefix,this.suffix=this._config.suffix,this.thousandSeparator=this._config.thousandSeparator,this.decimalMarker=this._config.decimalMarker,this.showMaskTyped=this._config.showMaskTyped,this.placeHolderCharacter=this._config.placeHolderCharacter,this.validation=this._config.validation,this.separatorLimit=this._config.separatorLimit,this.allowNegativeNumbers=this._config.allowNegativeNumbers,this.leadZeroDateTime=this._config.leadZeroDateTime,this.leadZero=this._config.leadZero,this.apm=this._config.apm,this.inputTransformFn=this._config.inputTransformFn,this.outputTransformFn=this._config.outputTransformFn,this.keepCharacterPositions=this._config.keepCharacterPositions,this._shift=new Set,this.plusOnePosition=!1,this.maskExpression="",this.actualValue="",this.showKeepCharacterExp="",this.shownMaskExpression="",this.deletedSpecialCharacter=!1,this._formatWithSeparators=(i,a,h,k)=>{let E=[],L="";if(Array.isArray(h)){const oe=new RegExp(h.map(W=>"[\\^$.|?*+()".indexOf(W)>=0?`\\${W}`:W).join("|"));E=i.split(oe),L=i.match(oe)?.[0]??""}else E=i.split(h),L=h;const w=E.length>1?`${L}${E[1]}`:"";let O=E[0]??"";const q=this.separatorLimit.replace(/\s/g,"");q&&+q&&(O="-"===O[0]?`-${O.slice(1,O.length).slice(0,q.length)}`:O.slice(0,q.length));const he=/(\d+)(\d{3})/;for(;a&&he.test(O);)O=O.replace(he,"$1"+a+"$2");return void 0===k?O+w:0===k?O:O+w.substring(0,k+1)},this.percentage=i=>{const a=i.replace(",","."),h=Number(this.allowNegativeNumbers&&i.includes("-")?a.slice(1,i.length):a);return!isNaN(h)&&h>=0&&h<=100},this.getPrecision=i=>{const a=i.split(".");return a.length>1?Number(a[a.length-1]):1/0},this.checkAndRemoveSuffix=i=>{for(let a=this.suffix?.length-1;a>=0;a--){const h=this.suffix.substring(a,this.suffix?.length);if(i.includes(h)&&a!==this.suffix?.length-1&&(a-1<0||!i.includes(this.suffix.substring(a-1,this.suffix?.length))))return i.replace(h,"")}return i},this.checkInputPrecision=(i,a,h)=>{if(a<1/0){if(Array.isArray(h)){const w=h.find(O=>O!==this.thousandSeparator);h=w||h[0]}const k=new RegExp(this._charToRegExpExpression(h)+`\\d{${a}}.*$`),E=i.match(k),L=(E&&E[0]?.length)??0;L-1>a&&(i=i.substring(0,i.length-(L-1-a))),0===a&&this._compareOrIncludes(i[i.length-1],h,this.thousandSeparator)&&(i=i.substring(0,i.length-1))}return i}}applyMaskWithPattern(i,a){const[h,k]=a;return this.customPattern=k,this.applyMask(i,h)}applyMask(i,a,h=0,k=!1,E=!1,L=(()=>{})){if(!a||"string"!=typeof i)return"";let w=0,O="",q=!1,he=!1,oe=1,W=!1;i.slice(0,this.prefix.length)===this.prefix&&(i=i.slice(this.prefix.length,i.length)),this.suffix&&i?.length>0&&(i=this.checkAndRemoveSuffix(i)),"("===i&&this.prefix&&(i="");const ne=i.toString().split("");if(this.allowNegativeNumbers&&"-"===i.slice(w,w+1)&&(O+=i.slice(w,w+1)),"IP"===a){const G=i.split(".");this.ipError=this._validIP(G),a="099.099.099.099"}const ae=[];for(let G=0;G<i.length;G++)i[G]?.match("\\d")&&ae.push(i[G]??"");if("CPF_CNPJ"===a&&(this.cpfCnpjError=11!==ae.length&&14!==ae.length,a=ae.length>11?"00.000.000/0000-00":"000.000.000-00"),a.startsWith("percent")){if(i.match("[a-z]|[A-Z]")||i.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!E){i=this._stripToDecimal(i);const ve=this.getPrecision(a);i=this.checkInputPrecision(i,ve,this.decimalMarker)}const G="string"==typeof this.decimalMarker?this.decimalMarker:".";if(i.indexOf(G)>0&&!this.percentage(i.substring(0,i.indexOf(G)))){let ve=i.substring(0,i.indexOf(G)-1);this.allowNegativeNumbers&&"-"===i.slice(w,w+1)&&!E&&(ve=i.substring(0,i.indexOf(G))),i=`${ve}${i.substring(i.indexOf(G),i.length)}`}let B="";B=this.allowNegativeNumbers&&"-"===i.slice(w,w+1)?`-${i.slice(w+1,w+i.length)}`:i,O=this.percentage(B)?this._splitPercentZero(i):this._splitPercentZero(i.substring(0,i.length-1))}else if(a.startsWith("separator")){(i.match("[w\u0430-\u044f\u0410-\u042f]")||i.match("[\u0401\u0451\u0410-\u044f]")||i.match("[a-z]|[A-Z]")||i.match(/[-@#!$%\\^&*()_\xa3\xac'+|~=`{}\]:";<>.?/]/)||i.match("[^A-Za-z0-9,]"))&&(i=this._stripToDecimal(i));const G=this.getPrecision(a),B=Array.isArray(this.decimalMarker)?".":this.decimalMarker;0===G?i=this.allowNegativeNumbers?i.length>2&&"-"===i[0]&&"0"===i[1]&&i[2]!==this.thousandSeparator&&","!==i[2]&&"."!==i[2]?"-"+i.slice(2,i.length):"0"===i[0]&&i.length>1&&i[1]!==this.thousandSeparator&&","!==i[1]&&"."!==i[1]?i.slice(1,i.length):i:i.length>1&&"0"===i[0]&&i[1]!==this.thousandSeparator&&","!==i[1]&&"."!==i[1]?i.slice(1,i.length):i:(i[0]===B&&i.length>1&&(i="0"+i.slice(0,i.length+1),this.plusOnePosition=!0),"0"===i[0]&&i[1]!==B&&i[1]!==this.thousandSeparator&&(i=i.length>1?i.slice(0,1)+B+i.slice(1,i.length+1):i,this.plusOnePosition=!0),this.allowNegativeNumbers&&"-"===i[0]&&(i[1]===B||"0"===i[1])&&(i=i[1]===B&&i.length>2?i.slice(0,1)+"0"+i.slice(1,i.length):"0"===i[1]&&i.length>2&&i[2]!==B?i.slice(0,2)+B+i.slice(2,i.length):i,this.plusOnePosition=!0)),E&&("0"===i[0]&&i[1]===this.decimalMarker&&("0"===i[h]||i[h]===this.decimalMarker)&&(i=i.slice(2,i.length)),"-"===i[0]&&"0"===i[1]&&i[2]===this.decimalMarker&&("0"===i[h]||i[h]===this.decimalMarker)&&(i="-"+i.slice(3,i.length)),i=this._compareOrIncludes(i[i.length-1],this.decimalMarker,this.thousandSeparator)?i.slice(0,i.length-1):i);const ve=this._charToRegExpExpression(this.thousandSeparator);let fe='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(ve,"");if(Array.isArray(this.decimalMarker))for(const ge of this.decimalMarker)fe=fe.replace(this._charToRegExpExpression(ge),"");else fe=fe.replace(this._charToRegExpExpression(this.decimalMarker),"");const K=new RegExp("["+fe+"]");i.match(K)&&(i=i.substring(0,i.length-1));const Ee=(i=this.checkInputPrecision(i,G,this.decimalMarker)).replace(new RegExp(ve,"g"),"");O=this._formatWithSeparators(Ee,this.thousandSeparator,this.decimalMarker,G);const Re=O.indexOf(",")-i.indexOf(","),H=O.length-i.length;if(O[h-1]===this.thousandSeparator&&this.prefix&&E)h-=1;else if(H>0&&O[h]!==this.thousandSeparator){he=!0;let ge=0;do{this._shift.add(h+ge),ge++}while(ge<H)}else O[h-1]===this.decimalMarker||-4===H||-3===H||","===O[h]?(this._shift.clear(),this._shift.add(h-1)):0!==Re&&h>0&&!(O.indexOf(",")>=h&&h>3)||!(O.indexOf(".")>=h&&h>3)&&H<=0?(this._shift.clear(),he=!0,oe=H,this._shift.add(h+=H)):this._shift.clear()}else for(let G=0,B=ne[0];G<ne.length&&w!==a.length;G++,B=ne[G]??""){const ve="*"in this.patterns;if(this._checkSymbolMask(B,a[w]??"")&&"?"===a[w+1])O+=B,w+=2;else if("*"===a[w+1]&&q&&this._checkSymbolMask(B,a[w+2]??""))O+=B,w+=3,q=!1;else if(this._checkSymbolMask(B,a[w]??"")&&"*"===a[w+1]&&!ve)O+=B,q=!0;else if("?"===a[w+1]&&this._checkSymbolMask(B,a[w+2]??""))O+=B,w+=3;else if(this._checkSymbolMask(B,a[w]??"")){if("H"===a[w]&&(this.apm?Number(B)>9:Number(B)>2)){h=this.leadZeroDateTime?h:h+1,w+=1,this._shiftStep(a,w,ne.length),G--,this.leadZeroDateTime&&(O+="0");continue}if("h"===a[w]&&(this.apm?1===O.length&&Number(O)>1||"1"===O&&Number(B)>2||1===i.slice(w-1,w).length&&Number(i.slice(w-1,w))>2||"1"===i.slice(w-1,w)&&Number(B)>2:"2"===O&&Number(B)>3||("2"===O.slice(w-2,w)||"2"===O.slice(w-3,w)||"2"===O.slice(w-4,w)||"2"===O.slice(w-1,w))&&Number(B)>3&&w>10)){h+=1,w+=1,G--;continue}if(("m"===a[w]||"s"===a[w])&&Number(B)>5){h=this.leadZeroDateTime?h:h+1,w+=1,this._shiftStep(a,w,ne.length),G--,this.leadZeroDateTime&&(O+="0");continue}const fe=31,K=i[w],Ee=i[w+1],Re=i[w+2],H=i[w-1],ge=i[w-2],hr=i[w-3],ke=i.slice(w-3,w-1),mt=i.slice(w-1,w+1),rt=i.slice(w,w+2),xt=i.slice(w-2,w);if("d"===a[w]){const Kt="M0"===a.slice(0,2),nt="M0"===a.slice(0,2)&&this.specialCharacters.includes(ge);if(Number(B)>3&&this.leadZeroDateTime||!Kt&&(Number(rt)>fe||Number(mt)>fe||this.specialCharacters.includes(Ee)&&!E)||(nt?Number(mt)>fe||!this.specialCharacters.includes(K)&&this.specialCharacters.includes(Re)||this.specialCharacters.includes(K):Number(rt)>fe||this.specialCharacters.includes(Ee)&&!E)){h=this.leadZeroDateTime?h:h+1,w+=1,this._shiftStep(a,w,ne.length),G--,this.leadZeroDateTime&&(O+="0");continue}}if("M"===a[w]){const nt=0===w&&(Number(B)>2||Number(rt)>12||this.specialCharacters.includes(Ee)&&!E),De=a.slice(w+2,w+3),Rt=ke.includes(De)&&a.includes("d0")&&(this.specialCharacters.includes(ge)&&Number(mt)>12&&!this.specialCharacters.includes(K)||this.specialCharacters.includes(K)||this.specialCharacters.includes(hr)&&Number(xt)>12&&!this.specialCharacters.includes(H)||this.specialCharacters.includes(H)),it=Number(ke)<=fe&&!this.specialCharacters.includes(ke)&&this.specialCharacters.includes(H)&&(Number(rt)>12||this.specialCharacters.includes(Ee)&&!E),Ft=Number(rt)>12&&5===w||this.specialCharacters.includes(Ee)&&5===w,st=Number(ke)>fe&&!this.specialCharacters.includes(ke)&&!this.specialCharacters.includes(xt)&&Number(xt)>12&&a.includes("d0"),at=Number(ke)<=fe&&!this.specialCharacters.includes(ke)&&!this.specialCharacters.includes(H)&&Number(mt)>12;if(Number(B)>1&&this.leadZeroDateTime||nt||Rt||at||st||it||Ft&&!this.leadZeroDateTime){h=this.leadZeroDateTime?h:h+1,w+=1,this._shiftStep(a,w,ne.length),G--,this.leadZeroDateTime&&(O+="0");continue}}O+=B,w++}else" "===B&&" "===a[w]||"/"===B&&"/"===a[w]?(O+=B,w++):-1!==this.specialCharacters.indexOf(a[w]??"")?(O+=a[w],w++,this._shiftStep(a,w,ne.length),G--):"9"===a[w]&&this.showMaskTyped?this._shiftStep(a,w,ne.length):this.patterns[a[w]??""]&&this.patterns[a[w]??""]?.optional?(ne[w]&&"099.099.099.099"!==a&&"000.000.000-00"!==a&&"00.000.000/0000-00"!==a&&!a.match(/^9+\.0+$/)&&!this.patterns[a[w]??""]?.optional&&(O+=ne[w]),a.includes("9*")&&a.includes("0*")&&w++,w++,G--):"*"===this.maskExpression[w+1]&&this._findSpecialChar(this.maskExpression[w+2]??"")&&this._findSpecialChar(B)===this.maskExpression[w+2]&&q||"?"===this.maskExpression[w+1]&&this._findSpecialChar(this.maskExpression[w+2]??"")&&this._findSpecialChar(B)===this.maskExpression[w+2]&&q?(w+=3,O+=B):this.showMaskTyped&&this.specialCharacters.indexOf(B)<0&&B!==this.placeHolderCharacter&&1===this.placeHolderCharacter.length&&(W=!0)}O.length+1===a.length&&-1!==this.specialCharacters.indexOf(a[a.length-1]??"")&&(O+=a[a.length-1]);let Ke=h+1;for(;this._shift.has(Ke);)oe++,Ke++;let qe=k&&!a.startsWith("separator")?w:this._shift.has(h)?oe:0;W&&qe--,L(qe,he),oe<0&&this._shift.clear();let Ne=!1;E&&(Ne=ne.every(G=>this.specialCharacters.includes(G)));let He=`${this.prefix}${Ne?"":O}${this.showMaskTyped?"":this.suffix}`;if(0===O.length&&(He=this.dropSpecialCharacters?`${O}`:`${this.prefix}${O}`),O.includes("-")&&this.prefix&&this.allowNegativeNumbers){if(E&&"-"===O)return"";He=`-${this.prefix}${O.split("-").join("")}${this.suffix}`}return He}_findDropSpecialChar(i){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(a=>a===i):this._findSpecialChar(i)}_findSpecialChar(i){return this.specialCharacters.find(a=>a===i)}_checkSymbolMask(i,a){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[a]?.pattern&&this.patterns[a]?.pattern.test(i))??!1}_stripToDecimal(i){return i.split("").filter((a,h)=>{const k="string"==typeof this.decimalMarker?a===this.decimalMarker:this.decimalMarker.includes(a);return a.match("^-?\\d")||a===this.thousandSeparator||k||"-"===a&&0===h&&this.allowNegativeNumbers}).join("")}_charToRegExpExpression(i){return i&&(" "===i?"\\s":"[\\^$.|?*+()".indexOf(i)>=0?`\\${i}`:i)}_shiftStep(i,a,h){const k=/[*?]/g.test(i.slice(0,a))?h:a;this._shift.add(k+this.prefix.length||0)}_compareOrIncludes(i,a,h){return Array.isArray(a)?a.filter(k=>k!==h).includes(i):i===a}_validIP(i){return!(4===i.length&&!i.some((a,h)=>i.length!==h+1?""===a||Number(a)>255:""===a||Number(a.substring(0,3))>255))}_splitPercentZero(i){if("-"===i&&this.allowNegativeNumbers)return i;const a=i.indexOf("string"==typeof this.decimalMarker?this.decimalMarker:"."),h=this.allowNegativeNumbers&&i.includes("-")?"-":"";if(-1===a){const k=parseInt(h?i.slice(1,i.length):i,10);return isNaN(k)?"":`${h}${k}`}{const k=parseInt(i.replace("-","").substring(0,a),10),E=i.substring(a+1),L=isNaN(k)?"":k.toString();return""===L?"":`${h}${L}${"string"==typeof this.decimalMarker?this.decimalMarker:"."}${E}`}}static#e=this.\u0275fac=function(a){return new(a||Y)};static#t=this.\u0275prov=F.jDH({token:Y,factory:Y.\u0275fac})}return Y})(),xe=(()=>{class Y extends Me{constructor(){super(...arguments),this.isNumberValue=!1,this.maskIsShown="",this.selStart=null,this.selEnd=null,this.writingValue=!1,this.maskChanged=!1,this._maskExpressionArray=[],this.triggerOnMaskChange=!1,this._previousValue="",this._currentValue="",this._emitValue=!1,this.onChange=i=>{},this._elementRef=(0,F.WQX)(F.aKT,{optional:!0}),this.document=(0,F.WQX)(V.qQ),this._config=(0,F.WQX)(Q),this._renderer=(0,F.WQX)(F.sFG,{optional:!0})}applyMask(i,a,h=0,k=!1,E=!1,L=(()=>{})){if(!a)return i!==this.actualValue?this.actualValue:i;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():"","IP"===this.maskExpression&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(i||"#")),"CPF_CNPJ"===this.maskExpression&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(i||"#")),!i&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;const w=i&&"number"==typeof this.selStart?i[this.selStart]??"":"";let O="";if(void 0!==this.hiddenInput&&!this.writingValue){let W=i&&1===i.length?i.split(""):this.actualValue.split("");"object"==typeof this.selStart&&"object"==typeof this.selEnd?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):""!==i&&W.length?"number"==typeof this.selStart&&"number"==typeof this.selEnd&&(i.length>W.length?W.splice(this.selStart,0,w):i.length<W.length&&(W.length-i.length==1?W.splice(E?this.selStart-1:i.length-1,1):W.splice(this.selStart,this.selEnd-this.selStart))):W=[],this.showMaskTyped&&(this.hiddenInput||(i=this.removeMask(i))),O=this.actualValue.length&&W.length<=i.length?this.shiftTypedSymbols(W.join("")):i}if(k&&(this.hiddenInput||!this.hiddenInput)&&(O=i),E&&-1!==this.specialCharacters.indexOf(this.maskExpression[h]??"")&&this.showMaskTyped&&!this.prefix&&(O=this._currentValue),this.deletedSpecialCharacter&&h&&(this.specialCharacters.includes(this.actualValue.slice(h,h+1))?h+=1:"M0"!==a.slice(h-1,h+1)&&(h-=2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&1===this.placeHolderCharacter.length&&!this.leadZeroDateTime&&(i=this.removeMask(i)),O=this.maskChanged?i:O&&O.length?O:i,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!k){const W=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(W),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}const q=super.applyMask(O,a,h,k,E,L);if(this.actualValue=this.getActualValue(q),"."===this.thousandSeparator&&"."===this.decimalMarker&&(this.decimalMarker=","),this.maskExpression.startsWith("separator")&&!0===this.dropSpecialCharacters&&(this.specialCharacters=this.specialCharacters.filter(W=>!this._compareOrIncludes(W,this.decimalMarker,this.thousandSeparator))),(q||""===q)&&(this._previousValue=this._currentValue,this._currentValue=q,this._emitValue=this._previousValue!==this._currentValue||this.maskChanged||this._previousValue===this._currentValue&&k),this._emitValue&&(this.writingValue?requestAnimationFrame(()=>this.formControlResult(q)):this.formControlResult(q)),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?E?this.hideInput(q,this.maskExpression):`${this.hideInput(q,this.maskExpression)}${this.maskIsShown.slice(q.length)}`:q;const he=q.length,oe=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes("H")){const W=this._numberSkipedSymbols(q);return`${q}${oe.slice(he+W)}`}return"IP"===this.maskExpression||"CPF_CNPJ"===this.maskExpression?`${q}${oe}`:`${q}${oe.slice(he)}`}_numberSkipedSymbols(i){const a=/(^|\D)(\d\D)/g;let h=a.exec(i),k=0;for(;null!=h;)k+=1,h=a.exec(i);return k}applyValueChanges(i,a,h,k=(()=>{})){const E=this._elementRef?.nativeElement;E&&(E.value=this.applyMask(E.value,this.maskExpression,i,a,h,k),E!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(i,a){return i.split("").map((h,k)=>this.patterns&&this.patterns[a[k]??""]&&this.patterns[a[k]??""]?.symbol?this.patterns[a[k]??""]?.symbol:h).join("")}getActualValue(i){const a=i.split("").filter((h,k)=>{const E=this.maskExpression[k]??"";return this._checkSymbolMask(h,E)||this.specialCharacters.includes(E)&&h===E});return a.join("")===i?a.join(""):i}shiftTypedSymbols(i){let a="";return(i&&i.split("").map((k,E)=>{if(this.specialCharacters.includes(i[E+1]??"")&&i[E+1]!==this.maskExpression[E+1])return a=k,i[E+1];if(a.length){const L=a;return a="",L}return k})||[]).join("")}numberToString(i){return!i&&0!==i||this.maskExpression.startsWith("separator")&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith("separator")&&this.separatorLimit.length>14&&String(i).length>14?String(i):Number(i).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace("/-/","-")}showMaskInInput(i){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}if(this.showMaskTyped){if(i){if("IP"===this.maskExpression)return this._checkForIp(i);if("CPF_CNPJ"===this.maskExpression)return this._checkForCpfCnpj(i)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){const i=this._elementRef?.nativeElement;i&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==i.value.replace(this.placeHolderCharacter,"").length&&(this.formElementProperty=["value",""],this.applyMask("",this.maskExpression))}set formElementProperty([i,a]){!this._renderer||!this._elementRef||Promise.resolve().then(()=>this._renderer?.setProperty(this._elementRef?.nativeElement,i,a))}checkDropSpecialCharAmount(i){return i.split("").filter(h=>this._findDropSpecialChar(h)).length}removeMask(i){return this._removeMask(this._removeSuffix(this._removePrefix(i)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(i){if("#"===i)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;const a=[];for(let h=0;h<i.length;h++){const k=i[h]??"";k&&k.match("\\d")&&a.push(k)}return a.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:a.length>3&&a.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:a.length>6&&a.length<=9?this.placeHolderCharacter:""}_checkForCpfCnpj(i){const a=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,h=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if("#"===i)return a;const k=[];for(let E=0;E<i.length;E++){const L=i[E]??"";L&&L.match("\\d")&&k.push(L)}return k.length<=3?a.slice(k.length,a.length):k.length>3&&k.length<=6?a.slice(k.length+1,a.length):k.length>6&&k.length<=9?a.slice(k.length+2,a.length):k.length>9&&k.length<11?a.slice(k.length+3,a.length):11===k.length?"":12===k.length?h.slice(17===i.length?16:15,h.length):k.length>12&&k.length<=14?h.slice(k.length+4,h.length):""}_getActiveElement(i=this.document){const a=i?.activeElement?.shadowRoot;return a?.activeElement?this._getActiveElement(a):i.activeElement}formControlResult(i){if(this.writingValue||!this.triggerOnMaskChange&&this.maskChanged)return this.maskChanged&&this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(i)))))),void(this.maskChanged=!1);Array.isArray(this.dropSpecialCharacters)?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(i)),this.dropSpecialCharacters))))):this.onChange(this.outputTransformFn(this._toNumber(this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===i?this._checkSymbols(this._removeSuffix(this._removePrefix(i))):i)))}_toNumber(i){if(!this.isNumberValue||""===i||this.maskExpression.startsWith("separator")&&(this.leadZero||!this.dropSpecialCharacters))return i;if(String(i).length>16&&this.separatorLimit.length>14)return String(i);const a=Number(i);if(this.maskExpression.startsWith("separator")&&Number.isNaN(a)){const h=String(i).replace(",",".");return Number(h)}return Number.isNaN(a)?i:a}_removeMask(i,a){return this.maskExpression.startsWith("percent")&&i.includes(".")?i:i&&i.replace(this._regExpForRemove(a),"")}_removePrefix(i){return this.prefix?i&&i.replace(this.prefix,""):i}_removeSuffix(i){return this.suffix?i&&i.replace(this.suffix,""):i}_retrieveSeparatorValue(i){let a=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(h=>this.dropSpecialCharacters.includes(h)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&i.includes(" ")&&this.maskExpression.includes("*")&&(a=a.filter(h=>" "!==h)),this._removeMask(i,a)}_regExpForRemove(i){return new RegExp(i.map(a=>`\\${a}`).join("|"),"gi")}_replaceDecimalMarkerToDot(i){const a=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return i.replace(this._regExpForRemove(a),".")}_checkSymbols(i){if(""===i)return i;this.maskExpression.startsWith("percent")&&","===this.decimalMarker&&(i=i.replace(",","."));const a=this._retrieveSeparatorPrecision(this.maskExpression),h=this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(i));return this.isNumberValue&&a?i===this.decimalMarker?null:this.separatorLimit.length>14?String(h):this._checkPrecision(this.maskExpression,h):h}_checkPatternForSpace(){for(const i in this.patterns)if(this.patterns[i]&&this.patterns[i]?.hasOwnProperty("pattern")){const a=this.patterns[i]?.pattern.toString(),h=this.patterns[i]?.pattern;if(a?.includes(" ")&&h?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(i){const a=i.match(new RegExp("^separator\\.([^d]*)"));return a?Number(a[1]):null}_checkPrecision(i,a){const h=i.slice(10,11);return i.indexOf("2")>0||this.leadZero&&Number(h)>1?(","===this.decimalMarker&&this.leadZero&&(a=a.replace(",",".")),this.leadZero?Number(a).toFixed(Number(h)):Number(a).toFixed(2)):this.numberToString(a)}_repeatPatternSymbols(i){return i.match(/{[0-9]+}/)&&i.split("").reduce((a,h,k)=>{if(this._start="{"===h?k:this._start,"}"!==h)return this._findSpecialChar(h)?a+h:a;this._end=k;const E=Number(i.slice(this._start+1,this._end)),L=new Array(E+1).join(i[this._start-1]);if(i.slice(0,this._start).length>1&&i.includes("S")){const w=i.slice(0,this._start-1);return w.includes("{")?a+L:w+a+L}return a+L},"")||i}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static#e=this.\u0275fac=(()=>{let i;return function(h){return(i||(i=F.xGo(Y)))(h||Y)}})();static#t=this.\u0275prov=F.jDH({token:Y,factory:Y.\u0275fac})}return Y})();function J(){const Y=(0,F.WQX)(et),Ce=(0,F.WQX)(Te);return Ce instanceof Function?{...Y,...Ce()}:{...Y,...Ce}}function jt(Y){return[{provide:Te,useValue:Y},{provide:et,useValue:le},{provide:Q,useFactory:J},xe]}let de=(()=>{class Y{constructor(){this.maskExpression="",this.specialCharacters=[],this.patterns={},this.prefix="",this.suffix="",this.thousandSeparator=" ",this.decimalMarker=".",this.dropSpecialCharacters=null,this.hiddenInput=null,this.showMaskTyped=null,this.placeHolderCharacter=null,this.shownMaskExpression=null,this.showTemplate=null,this.clearIfNotMatch=null,this.validation=null,this.separatorLimit=null,this.allowNegativeNumbers=null,this.leadZeroDateTime=null,this.leadZero=null,this.triggerOnMaskChange=null,this.apm=null,this.inputTransformFn=null,this.outputTransformFn=null,this.keepCharacterPositions=null,this.maskFilled=new F.bkB,this._maskValue="",this._position=null,this._maskExpressionArray=[],this._justPasted=!1,this._isFocused=!1,this._isComposing=!1,this.document=(0,F.WQX)(V.qQ),this._maskService=(0,F.WQX)(xe,{self:!0}),this._config=(0,F.WQX)(Q),this.onChange=i=>{},this.onTouch=()=>{}}ngOnChanges(i){const{maskExpression:a,specialCharacters:h,patterns:k,prefix:E,suffix:L,thousandSeparator:w,decimalMarker:O,dropSpecialCharacters:q,hiddenInput:he,showMaskTyped:oe,placeHolderCharacter:W,shownMaskExpression:ne,showTemplate:ae,clearIfNotMatch:Ke,validation:qe,separatorLimit:Ne,allowNegativeNumbers:He,leadZeroDateTime:G,leadZero:B,triggerOnMaskChange:ve,apm:fe,inputTransformFn:K,outputTransformFn:Ee,keepCharacterPositions:Re}=i;if(a&&(a.currentValue!==a.previousValue&&!a.firstChange&&(this._maskService.maskChanged=!0),a.currentValue&&a.currentValue.split("||").length>1?(this._maskExpressionArray=a.currentValue.split("||").sort((H,ge)=>H.length-ge.length),this._setMask()):(this._maskExpressionArray=[],this._maskValue=a.currentValue||"",this._maskService.maskExpression=this._maskValue)),h){if(!h.currentValue||!Array.isArray(h.currentValue))return;this._maskService.specialCharacters=h.currentValue||[]}He&&(this._maskService.allowNegativeNumbers=He.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter(H=>"-"!==H))),k&&k.currentValue&&(this._maskService.patterns=k.currentValue),fe&&fe.currentValue&&(this._maskService.apm=fe.currentValue),E&&(this._maskService.prefix=E.currentValue),L&&(this._maskService.suffix=L.currentValue),w&&(this._maskService.thousandSeparator=w.currentValue),O&&(this._maskService.decimalMarker=O.currentValue),q&&(this._maskService.dropSpecialCharacters=q.currentValue),he&&(this._maskService.hiddenInput=he.currentValue),oe&&(this._maskService.showMaskTyped=oe.currentValue,!1===oe.previousValue&&!0===oe.currentValue&&this._isFocused&&requestAnimationFrame(()=>{this._maskService._elementRef?.nativeElement.click()})),W&&(this._maskService.placeHolderCharacter=W.currentValue),ne&&(this._maskService.shownMaskExpression=ne.currentValue),ae&&(this._maskService.showTemplate=ae.currentValue),Ke&&(this._maskService.clearIfNotMatch=Ke.currentValue),qe&&(this._maskService.validation=qe.currentValue),Ne&&(this._maskService.separatorLimit=Ne.currentValue),G&&(this._maskService.leadZeroDateTime=G.currentValue),B&&(this._maskService.leadZero=B.currentValue),ve&&(this._maskService.triggerOnMaskChange=ve.currentValue),K&&(this._maskService.inputTransformFn=K.currentValue),Ee&&(this._maskService.outputTransformFn=Ee.currentValue),Re&&(this._maskService.keepCharacterPositions=Re.currentValue),this._applyMask()}validate({value:i}){if(!this._maskService.validation||!this._maskValue)return null;if(this._maskService.ipError)return this._createValidationError(i);if(this._maskService.cpfCnpjError)return this._createValidationError(i);if(this._maskValue.startsWith("separator")||tt.includes(this._maskValue)||this._maskService.clearIfNotMatch)return null;if(je.includes(this._maskValue))return this._validateTime(i);if(i&&i.toString().length>=1){let a=0;if(this._maskValue.startsWith("percent"))return null;for(const h in this._maskService.patterns)if(this._maskService.patterns[h]?.optional&&(this._maskValue.indexOf(h)!==this._maskValue.lastIndexOf(h)?a+=this._maskValue.split("").filter(E=>E===h).join("").length:-1!==this._maskValue.indexOf(h)&&a++,-1!==this._maskValue.indexOf(h)&&i.toString().length>=this._maskValue.indexOf(h)||a===this._maskValue.length))return null;if(1===this._maskValue.indexOf("{")&&i.toString().length===this._maskValue.length+Number((this._maskValue.split("{")[1]??"").split("}")[0])-4)return null;if(this._maskValue.indexOf("*")>1&&i.toString().length<this._maskValue.indexOf("*")||this._maskValue.indexOf("?")>1&&i.toString().length<this._maskValue.indexOf("?")||1===this._maskValue.indexOf("{"))return this._createValidationError(i);if(-1===this._maskValue.indexOf("*")||-1===this._maskValue.indexOf("?")){i="number"==typeof i?String(i):i;const h=this._maskValue.split("*"),k=this._maskService.dropSpecialCharacters?this._maskValue.length-this._maskService.checkDropSpecialCharAmount(this._maskValue)-a:this.prefix?this._maskValue.length+this.prefix.length-a:this._maskValue.length-a;if(1===h.length&&i.toString().length<k)return this._createValidationError(i);if(h.length>1){const E=h[h.length-1];if(E&&this._maskService.specialCharacters.includes(E[0])&&String(i).includes(E[0]??"")&&!this.dropSpecialCharacters){const L=i.split(E[0]);return L[L.length-1].length===E.length-1?null:this._createValidationError(i)}return(E&&!this._maskService.specialCharacters.includes(E[0])||!E||this._maskService.dropSpecialCharacters)&&i.length>=k-1?null:this._createValidationError(i)}}if(1===this._maskValue.indexOf("*")||1===this._maskValue.indexOf("?"))return null}return i&&this.maskFilled.emit(),null}onPaste(){this._justPasted=!0}onFocus(){this._isFocused=!0}onModelChange(i){(""===i||null==i)&&this._maskService.actualValue&&(this._maskService.actualValue=this._maskService.getActualValue(""))}onInput(i){if(this._isComposing)return;const a=i.target,h=this._maskService.inputTransformFn(a.value);if("number"!==a.type)if("string"==typeof h||"number"==typeof h){if(a.value=h.toString(),this._inputValue=a.value,this._setMask(),!this._maskValue)return void this.onChange(a.value);let k=1===a.selectionStart?a.selectionStart+this._maskService.prefix.length:a.selectionStart;if(this.showMaskTyped&&this.keepCharacterPositions&&1===this._maskService.placeHolderCharacter.length){const O=a.value.slice(k-1,k),q=this.prefix.length,he=this._maskService._checkSymbolMask(O,this._maskService.maskExpression[k-1-q]??""),oe=this._maskService._checkSymbolMask(O,this._maskService.maskExpression[k+1-q]??""),W=this._maskService.selStart===this._maskService.selEnd,ne=Number(this._maskService.selStart)-q,ae=Number(this._maskService.selEnd)-q;if("Backspace"===this._code)if(W){if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(k-this.prefix.length,k+1-this.prefix.length))&&W)if(1===ne&&this.prefix)this._maskService.actualValue=`${this.prefix}${this._maskService.placeHolderCharacter}${a.value.split(this.prefix).join("").split(this.suffix).join("")}${this.suffix}`,k-=1;else{const Ke=a.value.substring(0,k),qe=a.value.substring(k);this._maskService.actualValue=`${Ke}${this._maskService.placeHolderCharacter}${qe}`}}else this._maskService.actualValue=this._maskService.selStart===q?`${this.prefix}${this._maskService.maskIsShown.slice(0,ae)}${this._inputValue.split(this.prefix).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+q?`${this._inputValue}${this._maskService.maskIsShown.slice(ne,ae)}`:`${this.prefix}${this._inputValue.split(this.prefix).join("").slice(0,ne)}${this._maskService.maskIsShown.slice(ne,ae)}${this._maskService.actualValue.slice(ae+q,this._maskService.maskIsShown.length+q)}${this.suffix}`;"Backspace"!==this._code&&(he||oe||!W?this._maskService.specialCharacters.includes(a.value.slice(k,k+1))&&oe&&!this._maskService.specialCharacters.includes(a.value.slice(k+1,k+2))?(this._maskService.actualValue=`${a.value.slice(0,k-1)}${a.value.slice(k,k+1)}${O}${a.value.slice(k+2)}`,k+=1):he?this._maskService.actualValue=1===a.value.length&&1===k?`${this.prefix}${O}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${this.suffix}`:`${a.value.slice(0,k-1)}${O}${a.value.slice(k+1).split(this.suffix).join("")}${this.suffix}`:this.prefix&&1===a.value.length&&k-q==1&&this._maskService._checkSymbolMask(a.value,this._maskService.maskExpression[k-1-q]??"")&&(this._maskService.actualValue=`${this.prefix}${a.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${this.suffix}`):k=Number(a.selectionStart)-1)}let E=0,L=!1;if("Delete"===this._code&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue.length>=this._maskService.maskExpression.length-1&&"Backspace"!==this._code&&"d0/M0/0000"===this._maskService.maskExpression&&k<10){const O=this._inputValue.slice(k-1,k);a.value=this._inputValue.slice(0,k-1)+O+this._inputValue.slice(k+1)}if("d0/M0/0000"===this._maskService.maskExpression&&this.leadZeroDateTime&&(k<3&&Number(a.value)>31&&Number(a.value)<40||5===k&&Number(a.value.slice(3,5))>12)&&(k+=2),"Hh:m0:s0"===this._maskService.maskExpression&&this.apm&&(this._justPasted&&"00"===a.value.slice(0,2)&&(a.value=a.value.slice(1,2)+a.value.slice(2,a.value.length)),a.value="00"===a.value?"0":a.value),this._maskService.applyValueChanges(k,this._justPasted,"Backspace"===this._code||"Delete"===this._code,(O,q)=>{this._justPasted=!1,E=O,L=q}),this._getActiveElement()!==a)return;this._maskService.plusOnePosition&&(k+=1,this._maskService.plusOnePosition=!1),this._maskExpressionArray.length&&(k="Backspace"===this._code?this.specialCharacters.includes(this._inputValue.slice(k-1,k))?k-1:k:1===a.selectionStart?a.selectionStart+this._maskService.prefix.length:a.selectionStart),this._position=1===this._position&&1===this._inputValue.length?null:this._position;let w=this._position?this._inputValue.length+k+E:k+("Backspace"!==this._code||L?E:0);w>this._getActualInputLength()&&(w=a.value===this._maskService.decimalMarker&&1===a.value.length?this._getActualInputLength()+1:this._getActualInputLength()),w<0&&(w=0),a.setSelectionRange(w,w),this._position=null}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof h);else{if(!this._maskValue)return void this.onChange(a.value);this._maskService.applyValueChanges(a.value.length,this._justPasted,"Backspace"===this._code||"Delete"===this._code)}}onCompositionStart(){this._isComposing=!0}onCompositionEnd(i){this._isComposing=!1,this._justPasted=!0,this.onInput(i)}onBlur(i){if(this._maskValue){const a=i.target;if(this.leadZero&&a.value.length>0&&"string"==typeof this.decimalMarker){const h=this._maskService.maskExpression,k=Number(this._maskService.maskExpression.slice(h.length-1,h.length));if(k>1){a.value=this.suffix?a.value.split(this.suffix).join(""):a.value;const E=a.value.split(this.decimalMarker)[1];a.value=a.value.includes(this.decimalMarker)?a.value+"0".repeat(k-E.length)+this.suffix:a.value+this.decimalMarker+"0".repeat(k)+this.suffix,this._maskService.actualValue=a.value}}this._maskService.clearIfNotMatchFn()}this._isFocused=!1,this.onTouch()}onClick(i){if(!this._maskValue)return;const a=i.target;null!==a&&null!==a.selectionStart&&a.selectionStart===a.selectionEnd&&a.selectionStart>this._maskService.prefix.length&&38!==i.keyCode&&this._maskService.showMaskTyped&&!this.keepCharacterPositions&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),a.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===a.value?(a.focus(),a.setSelectionRange(0,0)):a.selectionStart>this._maskService.actualValue.length&&a.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));const E=a&&(a.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:a.value);a&&a.value!==E&&(a.value=E),a&&"number"!==a.type&&(a.selectionStart||a.selectionEnd)<=this._maskService.prefix.length?a.selectionStart=this._maskService.prefix.length:a&&a.selectionEnd>this._getActualInputLength()&&(a.selectionEnd=this._getActualInputLength())}onKeyDown(i){if(!this._maskValue)return;if(this._isComposing)return void("Enter"===i.key&&this.onCompositionEnd(i));this._code=i.code?i.code:i.key;const a=i.target;if(this._inputValue=a.value,this._setMask(),"number"!==a.type){if("ArrowUp"===i.key&&i.preventDefault(),"ArrowLeft"===i.key||"Backspace"===i.key||"Delete"===i.key){if("Backspace"===i.key&&0===a.value.length&&(a.selectionStart=a.selectionEnd),"Backspace"===i.key&&0!==a.selectionStart)if(this.specialCharacters=this.specialCharacters?.length?this.specialCharacters:this._config.specialCharacters,this.prefix.length>1&&a.selectionStart<=this.prefix.length)a.setSelectionRange(this.prefix.length,a.selectionEnd);else if(this._inputValue.length!==a.selectionStart&&1!==a.selectionStart)for(;this.specialCharacters.includes((this._inputValue[a.selectionStart-1]??"").toString())&&(this.prefix.length>=1&&a.selectionStart>this.prefix.length||0===this.prefix.length);)a.setSelectionRange(a.selectionStart-1,a.selectionEnd);this.checkSelectionOnDeletion(a),this._maskService.prefix.length&&a.selectionStart<=this._maskService.prefix.length&&a.selectionEnd<=this._maskService.prefix.length&&i.preventDefault(),"Backspace"===i.key&&!a.readOnly&&0===a.selectionStart&&a.selectionEnd===a.value.length&&0!==a.value.length&&(this._position=this._maskService.prefix?this._maskService.prefix.length:0,this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position))}this.suffix&&this.suffix.length>1&&this._inputValue.length-this.suffix.length<a.selectionStart?a.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length):("KeyA"===i.code&&i.ctrlKey||"KeyA"===i.code&&i.metaKey)&&(a.setSelectionRange(0,this._getActualInputLength()),i.preventDefault()),this._maskService.selStart=a.selectionStart,this._maskService.selEnd=a.selectionEnd}}writeValue(i){var a=this;return(0,we.A)(function*(){if("object"==typeof i&&null!==i&&"value"in i&&("disable"in i&&a.setDisabledState(!!i.disable),i=i.value),null!==i&&(i=a.inputTransformFn?a.inputTransformFn(i):i),"string"==typeof i||"number"==typeof i||null==i){(null==i||""===i)&&(a._maskService._currentValue="",a._maskService._previousValue="");let h=i;if("number"==typeof h||a._maskValue.startsWith("separator")){h=String(h);const k=a._maskService.currentLocaleDecimalMarker();Array.isArray(a._maskService.decimalMarker)||(h=a._maskService.decimalMarker!==k?h.replace(k,a._maskService.decimalMarker):h),Array.isArray(a._maskService.decimalMarker)&&"."===a.decimalMarker&&(a._maskService.decimalMarker=","),a._maskService.leadZero&&h&&a.maskExpression&&!1!==a.dropSpecialCharacters&&(h=a._maskService._checkPrecision(a._maskService.maskExpression,h)),","===a._maskService.decimalMarker&&(h=h.toString().replace(".",",")),a.maskExpression?.startsWith("separator")&&a.leadZero&&requestAnimationFrame(()=>{a._maskService.applyMask(h?.toString()??"",a._maskService.maskExpression)}),a._maskService.isNumberValue=!0}"string"!=typeof h&&(h=""),a._inputValue=h,a._setMask(),h&&a._maskService.maskExpression||a._maskService.maskExpression&&(a._maskService.prefix||a._maskService.showMaskTyped)?("function"!=typeof a.inputTransformFn&&(a._maskService.writingValue=!0),a._maskService.formElementProperty=["value",a._maskService.applyMask(h,a._maskService.maskExpression)],"function"!=typeof a.inputTransformFn&&(a._maskService.writingValue=!1)):a._maskService.formElementProperty=["value",h],a._inputValue=h}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof i)})()}registerOnChange(i){this._maskService.onChange=this.onChange=i}registerOnTouched(i){this.onTouch=i}_getActiveElement(i=this.document){const a=i?.activeElement?.shadowRoot;return a?.activeElement?this._getActiveElement(a):i.activeElement}checkSelectionOnDeletion(i){i.selectionStart=Math.min(Math.max(this.prefix.length,i.selectionStart),this._inputValue.length-this.suffix.length),i.selectionEnd=Math.min(Math.max(this.prefix.length,i.selectionEnd),this._inputValue.length-this.suffix.length)}setDisabledState(i){this._maskService.formElementProperty=["disabled",i]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue,this._maskService.maskExpression)]}_validateTime(i){const a=this._maskValue.split("").filter(h=>":"!==h).length;return i&&(0==+(i[i.length-1]??-1)&&i.length<a||i.length<=a-2)?this._createValidationError(i):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(i){return{mask:{requiredMask:this._maskValue,actualValue:i}}}_setMask(){this._maskExpressionArray.some(i=>{if(i.split("").some(h=>this._maskService.specialCharacters.includes(h))&&this._inputValue&&!i.includes("S")||i.includes("{")){const h=this._maskService.removeMask(this._inputValue)?.length<=this._maskService.removeMask(i)?.length;if(h)return this._maskValue=this.maskExpression=this._maskService.maskExpression=i.includes("{")?this._maskService._repeatPatternSymbols(i):i,h;{const k=this._maskExpressionArray[this._maskExpressionArray.length-1]??"";this._maskValue=this.maskExpression=this._maskService.maskExpression=k.includes("{")?this._maskService._repeatPatternSymbols(k):k}}else{const h=this._maskService.removeMask(this._inputValue)?.split("").every((k,E)=>{const L=i.charAt(E);return this._maskService._checkSymbolMask(k,L)});if(h)return this._maskValue=this.maskExpression=this._maskService.maskExpression=i,h}})}static#e=this.\u0275fac=function(a){return new(a||Y)};static#t=this.\u0275dir=F.FsC({type:Y,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(a,h){1&a&&F.bIt("paste",function(){return h.onPaste()})("focus",function(E){return h.onFocus(E)})("ngModelChange",function(E){return h.onModelChange(E)})("input",function(E){return h.onInput(E)})("compositionstart",function(E){return h.onCompositionStart(E)})("compositionend",function(E){return h.onCompositionEnd(E)})("blur",function(E){return h.onBlur(E)})("click",function(E){return h.onClick(E)})("keydown",function(E){return h.onKeyDown(E)})},inputs:{maskExpression:[F.Mj6.None,"mask","maskExpression"],specialCharacters:"specialCharacters",patterns:"patterns",prefix:"prefix",suffix:"suffix",thousandSeparator:"thousandSeparator",decimalMarker:"decimalMarker",dropSpecialCharacters:"dropSpecialCharacters",hiddenInput:"hiddenInput",showMaskTyped:"showMaskTyped",placeHolderCharacter:"placeHolderCharacter",shownMaskExpression:"shownMaskExpression",showTemplate:"showTemplate",clearIfNotMatch:"clearIfNotMatch",validation:"validation",separatorLimit:"separatorLimit",allowNegativeNumbers:"allowNegativeNumbers",leadZeroDateTime:"leadZeroDateTime",leadZero:"leadZero",triggerOnMaskChange:"triggerOnMaskChange",apm:"apm",inputTransformFn:"inputTransformFn",outputTransformFn:"outputTransformFn",keepCharacterPositions:"keepCharacterPositions"},outputs:{maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],standalone:!0,features:[F.Jv_([{provide:re.kq,useExisting:Y,multi:!0},{provide:re.cz,useExisting:Y,multi:!0},xe]),F.OA$]})}return Y})()}}]);